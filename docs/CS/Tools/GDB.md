### **1. 启动与退出**
- **启动 GDB**：
  ```bash
  gdb <可执行文件>          # 启动调试
  gdb <可执行文件> <core文件> # 调试核心转储文件
  ```

- **退出 GDB**：
  ```
  (gdb) q                  # 退出调试器
  ```

---

### **2. 设置断点**
| 命令                           | 说明                         |
|--------------------------------|------------------------------|
| `b main`                       | 在 `main` 函数处设置断点       |
| `b file.c:10`                  | 在 `file.c` 的第 10 行设断点  |
| `b *0x4005a7`                  | 在内存地址 `0x4005a7` 设断点  |
| `b func if x > 5`              | 条件断点（当 `x > 5` 时触发） |
| `info breakpoints`             | 查看所有断点信息               |
| `delete <断点编号>`            | 删除指定断点                  |
| `disable/enable <断点编号>`    | 禁用/启用断点                 |

---

### **3. 执行控制**
| 命令                | 说明                         |
|---------------------|------------------------------|
| `r`                 | 运行程序                      |
| `c`                 | 继续运行到下一个断点或程序结束 |
| `s`                 | 单步进入（进入函数内部）       |
| `n`                 | 单步跳过（执行下一行，不进入函数）|
| `finish`            | 执行完当前函数并返回          |
| `until <行号>`      | 执行到指定行号                |
| `kill`              | 终止正在运行的程序            |

---

### **4. 查看变量与内存**
| 命令                     | 说明                          |
|--------------------------|-------------------------------|
| `p x`                    | 打印变量 `x` 的值             |
| `p/x x`                  | 以十六进制格式打印 `x`         |
| `p *(int*)0x7fffffffde44`| 查看内存地址的内容             |
| `info registers`         | 查看寄存器的值                |
| `x/10w 0x7fffffffde44`   | 查看内存地址的 10 个 4 字节数据 |
| `watch x`                | 监视变量 `x` 的值变化（硬件断点）|

---

### **5. 堆栈与函数调用**
| 命令                     | 说明                          |
|--------------------------|-------------------------------|
| `bt`                     | 查看当前堆栈跟踪（backtrace） |
| `frame <帧编号>`         | 切换到指定堆栈帧              |
| `info args`              | 查看当前函数的参数            |
| `info locals`            | 查看当前函数的局部变量        |
| `up/down`                | 切换到上层/下层堆栈帧         |

---

### **6. 多线程调试**
| 命令                     | 说明                          |
|--------------------------|-------------------------------|
| `info threads`           | 查看所有线程信息              |
| `thread <线程编号>`      | 切换到指定线程                |
| `b file.c:10 thread 2`   | 在指定线程设置断点            |
| `set scheduler-locking on`| 锁定其他线程（仅调试当前线程）|

---

### **7. 高级功能**
| 命令                     | 说明                          |
|--------------------------|-------------------------------|
| `disassemble`            | 反汇编当前函数                |
| `set var x=5`            | 修改变量 `x` 的值为 5         |
| `define hook-stop`       | 定义每次断点触发时的钩子命令  |
| `source script.gdb`      | 加载并执行 GDB 脚本           |
| `tui enable`             | 启用图形化界面（分屏模式）     |

---

### **8. 调试崩溃程序**
- **生成核心转储文件**（Linux）：
  ```bash
  ulimit -c unlimited        # 允许生成 core 文件
  ./your_program            # 运行程序直到崩溃
  gdb ./your_program core   # 调试 core 文件
  ```

- **查看崩溃位置**：
  ```
  (gdb) bt                   # 查看崩溃时的堆栈
  (gdb) p $rip               # 查看崩溃时的指令指针
  ```

---

### **9. 常用快捷键**
- `Ctrl + C`：中断程序运行。
- `Enter`：重复上一条命令。
- `Tab`：自动补全命令或文件名。

---

### **示例场景**
**调试段错误（Segmentation Fault）**：
1. 启动调试：
   ```bash
   gdb ./your_program
   ```
2. 运行程序：
   ```
   (gdb) r
   ```
3. 程序崩溃后查看堆栈：
   ```
   (gdb) bt
   ```
4. 分析崩溃位置的变量：
   ```
   (gdb) frame 1
   (gdb) p x
   ```

<!-- 
断点

在使用 GDB（GNU Debugger）时，可以通过命令行来设置、查看、删除（消除）断点。以下是一些常用的 GDB 命令来管理断点：

1. **设置断点**：
   - `break main`：在 `main` 函数的开始处设置一个断点。
   - `break filename.c:linenumber`：在指定文件的指定行号处设置一个断点。

2. **查看所有断点**：
   - `info breakpoints`：列出所有断点及其详细信息。

3. **删除（消除）单个断点**：
   - `delete breakpoints编号`：删除指定编号的断点。编号是 GDB 分配给每个断点的唯一标识符，可以通过 `info breakpoints` 命令查看。
   - `clear filename.c:linenumber`：删除指定位置的断点。

4. **删除所有断点**：
   - `delete`：删除所有断点。
   - `delete all`：删除所有断点。

5. **禁用断点**：
   - `disable breakpoints编号`：禁用指定编号的断点。
   - `disable all`：禁用所有断点。

6. **启用断点**：
   - `enable breakpoints编号`：启用指定编号的断点。
   - `enable all`：启用所有断点。

7. **临时更改断点状态**：
   - `break filename.c:linenumber if condition`：设置一个条件断点，只有当 `condition` 为真时，程序才会在该断点处暂停。

8. **查看断点命令**：
   - `commands`：列出与指定断点关联的命令。
   - `commands number`：为指定编号的断点设置一系列命令，当程序在该断点处暂停时，这些命令将自动执行。

### 示例操作：

假设你已经启动了 GDB 并加载了程序：

```bash
gdb myprogram
```

1. **设置断点**：
   ```gdb
   break main
   ```

2. **查看所有断点**：
   ```gdb
   info breakpoints
   ```

3. **删除断点**：
   - 假设你想删除编号为 1 的断点：
     ```gdb
     delete breakpoints 1
     ```

4. **删除所有断点**：
   ```gdb
   delete
   ```

5. **禁用和启用断点**：
   - 禁用编号为 1 的断点：
     ```gdb
     disable breakpoints 1
     ```
   - 启用编号为 1 的断点：
     ```gdb
     enable breakpoints 1
     ```

6. **清除特定位置的断点**：
   ```gdb
   clear filename.c:100
   ```

通过这些命令，你可以有效地管理 GDB 中的断点，以便更精确地控制程序的调试过程。



在 GDB 中，`list` 命令用于显示当前断点处或指定位置的源代码。如果你想要从头开始打印程序的源代码，你可以按照以下步骤操作：

1. **启动 GDB**：
   启动 GDB 并加载你的程序：
   ```bash
   gdb myprogram
   ```

2. **设置断点**（可选）：
   如果你想从程序的入口点（通常是 `main` 函数）开始，可以设置一个断点：
   ```gdb
   break main
   ```

3. **运行程序**（可选）：
   运行程序直到它达到断点：
   ```gdb
   run
   ```

4. **从头开始打印**：
   要从头开始打印程序的源代码，你需要知道源文件的名称。使用 `list` 命令，后面跟上文件名和行号，例如：
   ```gdb
   list filename.c:1
   ```
   这将显示从指定文件的第一行开始的源代码。

5. **使用 `list` 命令**：
   如果你已经在程序的入口点设置了断点并运行了程序，你现在可以使用 `list` 命令来显示当前位置的源代码：
   ```gdb
   list
   ```
   不带参数的 `list` 命令将显示当前断点或当前执行行的源代码。

6. **向前打印源代码**：
   如果你想继续向前打印源代码，可以逐行单步执行，然后再次使用 `list` 命令。例如：
   ```gdb
   next
   list
   ```
   这将执行下一行代码，然后显示下一行的源代码。


请记住，`list` 命令默认显示当前行号的源代码，以及周围的几行代码，以便提供上下文。如果你的程序有多个源文件，你可能需要为每个文件分别使用 `list` 命令。


ll 查看文件
shell ls
shell cat 文件名 -->
