<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Zhang rz的个人网站"><meta name=author content=张瑞喆><link href=https://r-z-zhang-AI.github.io/CS/pl/Python/file-advance/ rel=canonical><link rel=alternate type=application/rss+xml title="RSS feed" href=../../../../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../../../../feed_rss_updated.xml><link rel=icon href=../../../../images/favicon_circle.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.10"><title>File advance - CosHub</title><link rel=stylesheet href=../../../../assets/stylesheets/main.4af4bdda.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M64%2032C28.7%2032%200%2060.7%200%2096v320c0%2035.3%2028.7%2064%2064%2064h224V368c0-26.5%2021.5-48%2048-48h112V96c0-35.3-28.7-64-64-64zm384%20320H336c-8.8%200-16%207.2-16%2016v112l32-32%2064-64z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M96%200C43%200%200%2043%200%2096v320c0%2053%2043%2096%2096%2096h320c17.7%200%2032-14.3%2032-32s-14.3-32-32-32v-64c17.7%200%2032-14.3%2032-32V32c0-17.7-14.3-32-32-32H96m0%20384h256v64H96c-17.7%200-32-14.3-32-32s14.3-32%2032-32m32-240c0-8.8%207.2-16%2016-16h192c8.8%200%2016%207.2%2016%2016s-7.2%2016-16%2016H144c-8.8%200-16-7.2-16-16m16%2048h192c8.8%200%2016%207.2%2016%2016s-7.2%2016-16%2016H144c-8.8%200-16-7.2-16-16s7.2-16%2016-16%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-40-176h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24m40-208a32%2032%200%201%201%200%2064%2032%2032%200%201%201%200-64%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M480%2032c0-12.9-7.8-24.6-19.8-29.6S434.5.2%20425.3%209.3L381.7%2053c-48%2048-113.1%2075-181%2075H64c-35.3%200-64%2028.7-64%2064v96c0%2035.3%2028.7%2064%2064%2064v128c0%2017.7%2014.3%2032%2032%2032h64c17.7%200%2032-14.3%2032-32V352h8.7c67.9%200%20133%2027%20181%2075l43.6%2043.6c9.2%209.2%2022.9%2011.9%2034.9%206.9s19.8-16.6%2019.8-29.6V300.3c18.6-8.8%2032-32.5%2032-60.4s-13.4-51.6-32-60.4zm-64%2076.7v262.6C357.2%20317.8%20280.5%20288%20200.7%20288H192v-96h8.7c79.8%200%20156.5-29.8%20215.3-83.3%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M438.6%20105.4c12.5%2012.5%2012.5%2032.8%200%2045.3l-256%20256c-12.5%2012.5-32.8%2012.5-45.3%200l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200L160%20338.7l233.4-233.3c12.5-12.5%2032.8-12.5%2045.3%200z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-86.2-346.7c7.9-22.3%2029.1-37.3%2052.8-37.3h58.3c34.9%200%2063.1%2028.3%2063.1%2063.1%200%2022.6-12.1%2043.5-31.7%2054.8L280%20264.4c-.2%2013-10.9%2023.6-24%2023.6-13.3%200-24-10.7-24-24v-13.5c0-8.6%204.6-16.5%2012.1-20.8l44.3-25.4c4.7-2.7%207.6-7.7%207.6-13.1%200-8.4-6.8-15.1-15.1-15.1h-58.3c-3.4%200-6.4%202.1-7.5%205.3l-.4%201.2c-4.4%2012.5-18.2%2019-30.6%2014.6s-19-18.2-14.6-30.6l.4-1.2zM224%20352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%2032c14.2%200%2027.3%207.5%2034.5%2019.8l216%20368c7.3%2012.4%207.3%2027.7.2%2040.1S486.3%20480%20472%20480H40c-14.3%200-27.6-7.7-34.7-20.1s-7-27.8.2-40.1l216-368C228.7%2039.5%20241.8%2032%20256%2032m0%20128c-13.3%200-24%2010.7-24%2024v112c0%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24V184c0-13.3-10.7-24-24-24m32%20224a32%2032%200%201%200-64%200%2032%2032%200%201%200%2064%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M459.1%2052.4%20442.6%206.5c-1.9-3.9-6.1-6.5-10.5-6.5s-8.5%202.6-10.4%206.5l-16.5%2045.9-46%2016.8c-4.3%201.6-7.3%205.9-7.2%2010.4%200%204.5%203%208.7%207.2%2010.2l45.7%2016.8%2016.8%2045.8c1.5%204.4%205.8%207.5%2010.4%207.5s8.9-3.1%2010.4-7.5l16.5-45.8%2045.7-16.8c4.2-1.5%207.2-5.7%207.2-10.2%200-4.6-3-8.9-7.2-10.4zm-132.4%2053c-12.5-12.5-32.8-12.5-45.3%200l-2.9%202.9c-22-8-45.8-12.3-70.5-12.3C93.1%2096%200%20189.1%200%20304s93.1%20208%20208%20208%20208-93.1%20208-208c0-24.7-4.3-48.5-12.2-70.5l2.9-2.9c12.5-12.5%2012.5-32.8%200-45.3l-80-80zM200%20192c-57.4%200-104%2046.6-104%20104v8c0%208.8-7.2%2016-16%2016s-16-7.2-16-16v-8c0-75.1%2060.9-136%20136-136h8c8.8%200%2016%207.2%2016%2016s-7.2%2016-16%2016z%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M416%20398.9c58.5-41.1%2096-104.1%2096-174.9C512%20100.3%20397.4%200%20256%200S0%20100.3%200%20224c0%2070.7%2037.5%20133.8%2096%20174.9V464c0%2026.5%2021.5%2048%2048%2048h48v-48c0-8.8%207.2-16%2016-16s16%207.2%2016%2016v48h64v-48c0-8.8%207.2-16%2016-16s16%207.2%2016%2016v48h48c26.5%200%2048-21.5%2048-48v-65.1M96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M320%200c17.7%200%2032%2014.3%2032%2032v64h120c39.8%200%2072%2032.2%2072%2072v272c0%2039.8-32.2%2072-72%2072H168c-39.8%200-72-32.2-72-72V168c0-39.8%2032.2-72%2072-72h120V32c0-17.7%2014.3-32%2032-32M208%20384c-8.8%200-16%207.2-16%2016s7.2%2016%2016%2016h32c8.8%200%2016-7.2%2016-16s-7.2-16-16-16zm96%200c-8.8%200-16%207.2-16%2016s7.2%2016%2016%2016h32c8.8%200%2016-7.2%2016-16s-7.2-16-16-16zm96%200c-8.8%200-16%207.2-16%2016s7.2%2016%2016%2016h32c8.8%200%2016-7.2%2016-16s-7.2-16-16-16zM264%20256a40%2040%200%201%200-80%200%2040%2040%200%201%200%2080%200m152%2040a40%2040%200%201%200%200-80%2040%2040%200%201%200%200%2080M48%20224h16v192H48c-26.5%200-48-21.5-48-48v-96c0-26.5%2021.5-48%2048-48m544%200c26.5%200%2048%2021.5%2048%2048v96c0%2026.5-21.5%2048-48%2048h-16V224z%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v132.8c0%2011.8-3.3%2023.5-9.5%2033.5L10.3%20406.2C3.6%20417.2%200%20429.7%200%20442.6%200%20480.9%2031.1%20512%2069.4%20512h309.2c38.3%200%2069.4-31.1%2069.4-69.4%200-12.8-3.6-25.4-10.3-36.4L329.5%20230.4c-6.2-10.1-9.5-21.7-9.5-33.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20196.8V64h64v132.8c0%2023.7%206.6%2046.9%2019%2067.1l34.5%2056.1h-171l34.5-56.1c12.4-20.2%2019-43.4%2019-67.1%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64V216m256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64V216%22/%3E%3C/svg%3E');}</style><style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M12%2022c.8%200%201.6-.1%202.3-.3-.4-.5-.8-1.1-1-1.8-.4.1-.9.1-1.3.1-4.4%200-8-3.6-8-8s3.6-8%208-8c.8%200%201.5.1%202.2.3l1.6-1.6C14.6%202.3%2013.3%202%2012%202%206.5%202%202%206.5%202%2012s4.5%2010%2010%2010M6.5%2011.5l1.4-1.4%203.1%203.1%208.6-8.6L21%206%2011%2016zM19%2014l-1.26%202.75L15%2018l2.74%201.26L19%2022l1.25-2.74L23%2018l-2.75-1.25z%22/%3E%3C/svg%3E');}</style><link rel=stylesheet href=../../../../css/timeline.css><link rel=stylesheet href=../../../../mkdocs/css/custom.css><link rel=stylesheet href=../../../../mkdocs/css/emoji.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css><link rel=stylesheet href=../../../../pymdownx.inlinehilite><link rel=stylesheet href=../../../../pymdownx.snippets><link rel=stylesheet href=../../../../pymdownx.superfences><link rel=stylesheet href=../../../../admonition><link rel=stylesheet href=../../../../pymdownx.details><link rel=stylesheet href=../../../../footnotes><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#csvcsv class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title=CosHub class="md-header__button md-logo" aria-label=CosHub data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> CosHub </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> File advance </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=purple data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=purple data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/r-z-zhang-AI/r-z-zhang-AI.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> CosHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../.. class=md-tabs__link> 主页 </a> </li> <li class=md-tabs__item> <a href=../../../../ME/ class=md-tabs__link> 个人 </a> </li> <li class=md-tabs__item> <a href=../../../../KNOWLEDGE/ class=md-tabs__link> 数学 </a> </li> <li class=md-tabs__item> <a href=../../../ class=md-tabs__link> 开发 </a> </li> <li class=md-tabs__item> <a href=../../../../BOOK/ class=md-tabs__link> 阅读 </a> </li> <li class=md-tabs__item> <a href=../../../../PUBLIC/ class=md-tabs__link> 公众 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title=CosHub class="md-nav__button md-logo" aria-label=CosHub data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> CosHub </label> <div class=md-nav__source> <a href=https://github.com/r-z-zhang-AI/r-z-zhang-AI.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> CosHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=../../../.. class="md-nav__link "> <span class=md-ellipsis> 主页 </span> </a> <label class="md-nav__link " for=__nav_1 id=__nav_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> 主页 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_2> <div class="md-nav__link md-nav__container"> <a href=../../../../countdown/gee/ class="md-nav__link "> <span class=md-ellipsis> 倒计时 </span> </a> <label class="md-nav__link " for=__nav_1_2 id=__nav_1_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> 倒计时 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../countdown/birthday/ class=md-nav__link> <span class=md-ellipsis> 生日倒计时 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__container"> <a href=../../../../ME/ class="md-nav__link "> <span class=md-ellipsis> 个人 </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 个人 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> 思考 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> 思考 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../ME/THOUGHT/colledge-education-and-my-future/ class=md-nav__link> <span class=md-ellipsis> 大学教育与人生发展 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> SDFZ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> SDFZ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../ME/SDFZ/391forever/ class=md-nav__link> <span class=md-ellipsis> 永远的391 </span> </a> </li> <li class=md-nav__item> <a href=../../../../ME/SDFZ/sdfz_memorior/ class=md-nav__link> <span class=md-ellipsis> 附中回忆录 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> ZJU </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> ZJU </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_1> <label class=md-nav__link for=__nav_2_4_1 id=__nav_2_4_1_label tabindex=0> <span class=md-ellipsis> 面试经历 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_1> <span class="md-nav__icon md-icon"></span> 面试经历 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../ME/ZJU/interview/interview%20for%20SU/ class=md-nav__link> <span class=md-ellipsis> 学生会 </span> </a> </li> <li class=md-nav__item> <a href=../../../../ME/ZJU/interview/interview%20for%20major/ class=md-nav__link> <span class=md-ellipsis> 专业确认 </span> </a> </li> <li class=md-nav__item> <a href=../../../../ME/ZJU/interview/interview-for-qzwx/ class=md-nav__link> <span class=md-ellipsis> 启真问学 </span> </a> </li> <li class=md-nav__item> <a href=../../../../ME/ZJU/interview/x-lab-application/ class=md-nav__link> <span class=md-ellipsis> X-lab问卷 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_2> <label class=md-nav__link for=__nav_2_4_2 id=__nav_2_4_2_label tabindex=0> <span class=md-ellipsis> 计划 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_2> <span class="md-nav__icon md-icon"></span> 计划 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../ME/ZJU/plan/plan-for-24winter-holiday/ class=md-nav__link> <span class=md-ellipsis> 24寒假 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_3> <label class=md-nav__link for=__nav_2_4_3 id=__nav_2_4_3_label tabindex=0> <span class=md-ellipsis> 学习 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_3> <span class="md-nav__icon md-icon"></span> 学习 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../ME/ZJU/learn/resoure/ class=md-nav__link> <span class=md-ellipsis> 资源 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5 id=__nav_2_5_label tabindex=0> <span class=md-ellipsis> 随笔 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> 随笔 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../ME/ESSAY/2024-11/ class=md-nav__link> <span class=md-ellipsis> 2024-11 </span> </a> </li> <li class=md-nav__item> <a href=../../../../ME/ESSAY/2024-12/ class=md-nav__link> <span class=md-ellipsis> 2024-12 </span> </a> </li> <li class=md-nav__item> <a href=../../../../ME/ESSAY/2025-01/ class=md-nav__link> <span class=md-ellipsis> 2025-01 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../../../KNOWLEDGE/ class="md-nav__link "> <span class=md-ellipsis> 数学 </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 数学 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> 微积分 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> 微积分 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../KNOWLEDGE/calculus/knowledge-frame-of-calculus/ class=md-nav__link> <span class=md-ellipsis> 知识体系 </span> </a> </li> <li class=md-nav__item> <a href=../../../../KNOWLEDGE/calculus/series/ class=md-nav__link> <span class=md-ellipsis> 级数 </span> </a> </li> <li class=md-nav__item> <a href=../../../../KNOWLEDGE/calculus/summary-of-calculus/ class=md-nav__link> <span class=md-ellipsis> 方法总结 </span> </a> </li> <li class=md-nav__item> <a href=../../../../KNOWLEDGE/calculus/thought-for-calculus/ class=md-nav__link> <span class=md-ellipsis> 思想方法 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> 线性代数 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> 线性代数 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../KNOWLEDGE/linear-algebra/knowledge-frame-of-LA/ class=md-nav__link> <span class=md-ellipsis> 知识体系 </span> </a> </li> <li class=md-nav__item> <a href=../../../../KNOWLEDGE/linear-algebra/summary-of-LA/ class=md-nav__link> <span class=md-ellipsis> 方法总结 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> 离散数学 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> 离散数学 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../KNOWLEDGE/discrete/chap-1/ class=md-nav__link> <span class=md-ellipsis> Chap1 逻辑和证明 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex=0> <span class=md-ellipsis> 大学物理 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> 大学物理 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../KNOWLEDGE/physics/dynamics-motion/ class=md-nav__link> <span class=md-ellipsis> 力与运动 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../../ class="md-nav__link "> <span class=md-ellipsis> 开发 </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> 开发 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> 实战开发 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> 实战开发 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../develop/project/ class=md-nav__link> <span class=md-ellipsis> 项目组织 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/git/ class=md-nav__link> <span class=md-ellipsis> Git规范 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/programming/ class=md-nav__link> <span class=md-ellipsis> 编程风格 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class=md-ellipsis> 编程语言 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> 编程语言 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3_1> <label class=md-nav__link for=__nav_4_3_1 id=__nav_4_3_1_label tabindex=0> <span class=md-ellipsis> C/C++ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3_1> <span class="md-nav__icon md-icon"></span> C/C++ </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3_1_1> <label class=md-nav__link for=__nav_4_3_1_1 id=__nav_4_3_1_1_label tabindex=0> <span class=md-ellipsis> C语言 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_4_3_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3_1_1> <span class="md-nav__icon md-icon"></span> C语言 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../C_Cpp/C/c-note/ class=md-nav__link> <span class=md-ellipsis> 学习笔记 </span> </a> </li> <li class=md-nav__item> <a href=../../C_Cpp/C/c-errors-and-tips/ class=md-nav__link> <span class=md-ellipsis> 错题整理 </span> </a> </li> <li class=md-nav__item> <a href=../../C_Cpp/C/linkedList/ class=md-nav__link> <span class=md-ellipsis> 链表 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3_1_2> <label class=md-nav__link for=__nav_4_3_1_2 id=__nav_4_3_1_2_label tabindex=0> <span class=md-ellipsis> C++ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_4_3_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3_1_2> <span class="md-nav__icon md-icon"></span> C++ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../none.md class=md-nav__link> <span class=md-ellipsis> 学习笔记 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3_2> <label class=md-nav__link for=__nav_4_3_2 id=__nav_4_3_2_label tabindex=0> <span class=md-ellipsis> Python </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3_2> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../py-basic-grammar/ class=md-nav__link> <span class=md-ellipsis> 基础语法 </span> </a> </li> <li class=md-nav__item> <a href=../py-sequence/ class=md-nav__link> <span class=md-ellipsis> 数据容器 </span> </a> </li> <li class=md-nav__item> <a href=../file.md class=md-nav__link> <span class=md-ellipsis> 文件和异常 </span> </a> </li> <li class=md-nav__item> <a href=../py-oop/ class=md-nav__link> <span class=md-ellipsis> 面向对象 </span> </a> </li> <li class=md-nav__item> <a href=../development-in-py/ class=md-nav__link> <span class=md-ellipsis> 项目开发 </span> </a> </li> <li class=md-nav__item> <a href=../clock-in/ class=md-nav__link> <span class=md-ellipsis> 百日打卡 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class=md-ellipsis> 计算机系统 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> 计算机系统 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4_1> <label class=md-nav__link for=__nav_4_4_1 id=__nav_4_4_1_label tabindex=0> <span class=md-ellipsis> 数字逻辑设计 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4_1> <span class="md-nav__icon md-icon"></span> 数字逻辑设计 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../system/digital-design/chap1/ class=md-nav__link> <span class=md-ellipsis> Chapter 1 数字系统与信息 </span> </a> </li> <li class=md-nav__item> <a href=../../../system/digital-design/chap2/ class=md-nav__link> <span class=md-ellipsis> Chapter 2 组合逻辑电路 </span> </a> </li> <li class=md-nav__item> <a href=../../../system/digital-design/chap3/ class=md-nav__link> <span class=md-ellipsis> Chapter 3 组合逻辑电路的设计 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5> <label class=md-nav__link for=__nav_4_5 id=__nav_4_5_label tabindex=0> <span class=md-ellipsis> 算法相关 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> 算法相关 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5_1> <div class="md-nav__link md-nav__container"> <a href=../../../algorithm/fds/ class="md-nav__link "> <span class=md-ellipsis> 数据结构基础 </span> </a> <label class="md-nav__link " for=__nav_4_5_1 id=__nav_4_5_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_5_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5_1> <span class="md-nav__icon md-icon"></span> 数据结构基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../algorithm/fds/chap2/ class=md-nav__link> <span class=md-ellipsis> 算法分析 </span> </a> </li> <li class=md-nav__item> <a href=../../../algorithm/fds/chap3/ class=md-nav__link> <span class=md-ellipsis> Chapter 3 ADT & Stack & Queue </span> </a> </li> <li class=md-nav__item> <a href=../../../algorithm/fds/chap4/ class=md-nav__link> <span class=md-ellipsis> Chapter 4 Tree </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../algorithm/misc/ class=md-nav__link> <span class=md-ellipsis> Misc </span> </a> </li> <li class=md-nav__item> <a href=../../../algorithm/sort/ class=md-nav__link> <span class=md-ellipsis> Sort </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_6> <label class=md-nav__link for=__nav_4_6 id=__nav_4_6_label tabindex=0> <span class=md-ellipsis> 操作系统 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> 操作系统 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_6_1> <label class=md-nav__link for=__nav_4_6_1 id=__nav_4_6_1_label tabindex=0> <span class=md-ellipsis> Linux </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_6_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6_1> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../OS/linux/wsl-record/ class=md-nav__link> <span class=md-ellipsis> WSL备忘录 </span> </a> </li> <li class=md-nav__item> <a href=../../../OS/linux/vm-record/ class=md-nav__link> <span class=md-ellipsis> 虚拟机备忘录 </span> </a> </li> <li class=md-nav__item> <a href=../../../OS/linux/wsl-note/ class=md-nav__link> <span class=md-ellipsis> WSL操作指南 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../OS/windows/win-note/ class=md-nav__link> <span class=md-ellipsis> Windows备忘录 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_7> <label class=md-nav__link for=__nav_4_7 id=__nav_4_7_label tabindex=0> <span class=md-ellipsis> 网络安全 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_7_label aria-expanded=false> <label class=md-nav__title for=__nav_4_7> <span class="md-nav__icon md-icon"></span> 网络安全 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../IS/basic/ class=md-nav__link> <span class=md-ellipsis> 基础 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_8> <label class=md-nav__link for=__nav_4_8 id=__nav_4_8_label tabindex=0> <span class=md-ellipsis> 区块链 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_8_label aria-expanded=false> <label class=md-nav__title for=__nav_4_8> <span class="md-nav__icon md-icon"></span> 区块链 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../blockchain/background/ class=md-nav__link> <span class=md-ellipsis> 基础引入 </span> </a> </li> <li class=md-nav__item> <a href=../../../blockchain/theory/ class=md-nav__link> <span class=md-ellipsis> 技术原理 </span> </a> </li> <li class=md-nav__item> <a href=../../../blockchain/usage/ class=md-nav__link> <span class=md-ellipsis> 实际应用 </span> </a> </li> <li class=md-nav__item> <a href=../../../blockchain/bitcoin/ class=md-nav__link> <span class=md-ellipsis> 比特币 </span> </a> </li> <li class=md-nav__item> <a href=../../../blockchain/digital-currency/ class=md-nav__link> <span class=md-ellipsis> 数字货币 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_9> <label class=md-nav__link for=__nav_4_9 id=__nav_4_9_label tabindex=0> <span class=md-ellipsis> 人工智能 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_9_label aria-expanded=false> <label class=md-nav__title for=__nav_4_9> <span class="md-nav__icon md-icon"></span> 人工智能 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_9_1> <label class=md-nav__link for=__nav_4_9_1 id=__nav_4_9_1_label tabindex=0> <span class=md-ellipsis> 机器学习 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_9_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_9_1> <span class="md-nav__icon md-icon"></span> 机器学习 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../AI/ML/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E8%AE%B2%E7%A8%BF.ipynb class=md-nav__link> <span class=md-ellipsis> RUC讲稿 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../AI/AI/ class=md-nav__link> <span class=md-ellipsis> AI </span> </a> </li> <li class=md-nav__item> <a href=../../../AI/ANN/ class=md-nav__link> <span class=md-ellipsis> ANN </span> </a> </li> <li class=md-nav__item> <a href=../../../AI/DL/ class=md-nav__link> <span class=md-ellipsis> DL </span> </a> </li> <li class=md-nav__item> <a href=../../../AI/ML/ class=md-nav__link> <span class=md-ellipsis> ML </span> </a> </li> <li class=md-nav__item> <a href=../../../AI/Turing/ class=md-nav__link> <span class=md-ellipsis> Turing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_10> <label class=md-nav__link for=__nav_4_10 id=__nav_4_10_label tabindex=0> <span class=md-ellipsis> 实用工具 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_10_label aria-expanded=false> <label class=md-nav__title for=__nav_4_10> <span class="md-nav__icon md-icon"></span> 实用工具 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Tools/shell/ class=md-nav__link> <span class=md-ellipsis> shell </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/CSS/ class=md-nav__link> <span class=md-ellipsis> CSS </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/HTML/ class=md-nav__link> <span class=md-ellipsis> HTML </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/Git%20%26%20GitHub/ class=md-nav__link> <span class=md-ellipsis> Git&GitHub </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/docker/ class=md-nav__link> <span class=md-ellipsis> Docker </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/Markdown%28obsidian%29/ class=md-nav__link> <span class=md-ellipsis> Markdown </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/LaTeX/ class=md-nav__link> <span class=md-ellipsis> LaTeX </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/Linux/ class=md-nav__link> <span class=md-ellipsis> Linux </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/vim/ class=md-nav__link> <span class=md-ellipsis> vim </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/GDB/ class=md-nav__link> <span class=md-ellipsis> GDB </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/Obsidian/ class=md-nav__link> <span class=md-ellipsis> Obsidian </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/mkdocs/ class=md-nav__link> <span class=md-ellipsis> Mkdocs </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/makefile/ class=md-nav__link> <span class=md-ellipsis> Makefile </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/anaconda/ class=md-nav__link> <span class=md-ellipsis> Anaconda </span> </a> </li> <li class=md-nav__item> <a href=../../../Tools/vmware-linux/ class=md-nav__link> <span class=md-ellipsis> VMware </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11> <label class=md-nav__link for=__nav_4_11 id=__nav_4_11_label tabindex=0> <span class=md-ellipsis> 杂七杂八 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_11_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11> <span class="md-nav__icon md-icon"></span> 杂七杂八 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Misc/things-i-wanna-know/ class=md-nav__link> <span class=md-ellipsis> 想了解的东西 </span> </a> </li> <li class=md-nav__item> <a href=../../../Misc/regex/ class=md-nav__link> <span class=md-ellipsis> 正则表达式 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../../../BOOK/ class="md-nav__link "> <span class=md-ellipsis> 阅读 </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> 阅读 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> 文学名著 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> 文学名著 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../BOOK/fictions/%E5%B1%B1%E8%8C%B6%E6%96%87%E5%85%B7%E5%BA%97/ class=md-nav__link> <span class=md-ellipsis> 山茶文具店 </span> </a> </li> <li class=md-nav__item> <a href=../../../../BOOK/fictions/twilight/ class=md-nav__link> <span class=md-ellipsis> 暮光之城 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex=0> <span class=md-ellipsis> 专业书籍 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> 专业书籍 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../1.md class=md-nav__link> <span class=md-ellipsis> None </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../../../PUBLIC/ class="md-nav__link "> <span class=md-ellipsis> 公众 </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> 公众 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../PUBLIC/xiumi/ class=md-nav__link> <span class=md-ellipsis> 秀米 </span> </a> </li> <li class=md-nav__item> <a href=../../../../PUBLIC/nezha/ class=md-nav__link> <span class=md-ellipsis> 哪吒 </span> </a> </li> <li class=md-nav__item> <a href=../../../../PUBLIC/work-report/ class=md-nav__link> <span class=md-ellipsis> 工作汇报 </span> </a> </li> <li class=md-nav__item> <a href=../../../../PUBLIC/reimbursement/ class=md-nav__link> <span class=md-ellipsis> 报销工作注意事项 </span> </a> </li> <li class=md-nav__item> <a href=../../../../PUBLIC/zju-vlog/ class=md-nav__link> <span class=md-ellipsis> ZJU-vlog </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#csvcsv class=md-nav__link> <span class=md-ellipsis> csv文件与csv库 </span> </a> <nav class=md-nav aria-label=csv文件与csv库> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-csv class=md-nav__link> <span class=md-ellipsis> 1. 读取 CSV 文件 </span> </a> <nav class=md-nav aria-label="1. 读取 CSV 文件"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-csvreader class=md-nav__link> <span class=md-ellipsis> (1) csv.reader </span> </a> </li> <li class=md-nav__item> <a href=#2-csvdictreader class=md-nav__link> <span class=md-ellipsis> (2) csv.DictReader </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-csv class=md-nav__link> <span class=md-ellipsis> 2. 写入 CSV 文件 </span> </a> <nav class=md-nav aria-label="2. 写入 CSV 文件"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-csvwriter class=md-nav__link> <span class=md-ellipsis> (1) csv.writer </span> </a> </li> <li class=md-nav__item> <a href=#2-csvdictwriter class=md-nav__link> <span class=md-ellipsis> (2) csv.DictWriter </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3 class=md-nav__link> <span class=md-ellipsis> 3. 其他功能 </span> </a> <nav class=md-nav aria-label="3. 其他功能"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-csvregister_dialect class=md-nav__link> <span class=md-ellipsis> (1) csv.register_dialect </span> </a> </li> <li class=md-nav__item> <a href=#2-csvunregister_dialect class=md-nav__link> <span class=md-ellipsis> (2) csv.unregister_dialect </span> </a> </li> <li class=md-nav__item> <a href=#3-csvlist_dialects class=md-nav__link> <span class=md-ellipsis> (3) csv.list_dialects </span> </a> </li> <li class=md-nav__item> <a href=#4-csvget_dialect class=md-nav__link> <span class=md-ellipsis> (4) csv.get_dialect </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#excel class=md-nav__link> <span class=md-ellipsis> Excel文件 </span> </a> <nav class=md-nav aria-label=Excel文件> <ul class=md-nav__list> <li class=md-nav__item> <a href=#excel_1 class=md-nav__link> <span class=md-ellipsis> Excel简介 </span> </a> </li> <li class=md-nav__item> <a href=#excel_2 class=md-nav__link> <span class=md-ellipsis> 读Excel文件 </span> </a> </li> <li class=md-nav__item> <a href=#excel_3 class=md-nav__link> <span class=md-ellipsis> 写Excel文件 </span> </a> <nav class=md-nav aria-label=写Excel文件> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 调整单元格样式 </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 公式计算 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 简单的总结 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#25pythonexcel-2 class=md-nav__link> <span class=md-ellipsis> 第25课：用Python读写Excel文件-2 </span> </a> <nav class=md-nav aria-label=第25课：用Python读写Excel文件-2> <ul class=md-nav__list> <li class=md-nav__item> <a href=#excel_4 class=md-nav__link> <span class=md-ellipsis> Excel简介 </span> </a> </li> <li class=md-nav__item> <a href=#excel_5 class=md-nav__link> <span class=md-ellipsis> 读取Excel文件 </span> </a> </li> <li class=md-nav__item> <a href=#excel_6 class=md-nav__link> <span class=md-ellipsis> 写Excel文件 </span> </a> <nav class=md-nav aria-label=写Excel文件> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 调整样式和公式计算 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 生成统计图表 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#27pythonpdf class=md-nav__link> <span class=md-ellipsis> 第27课：用Python操作PDF文件 </span> </a> <nav class=md-nav aria-label=第27课：用Python操作PDF文件> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pdf class=md-nav__link> <span class=md-ellipsis> 从PDF中提取文本 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 旋转和叠加页面 </span> </a> </li> <li class=md-nav__item> <a href=#pdf_1 class=md-nav__link> <span class=md-ellipsis> 加密PDF文件 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 批量添加水印 </span> </a> </li> <li class=md-nav__item> <a href=#pdf_2 class=md-nav__link> <span class=md-ellipsis> 创建PDF文件 </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 简单的总结 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#28python class=md-nav__link> <span class=md-ellipsis> 第28课：用Python处理图像 </span> </a> <nav class=md-nav aria-label=第28课：用Python处理图像> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 入门知识 </span> </a> </li> <li class=md-nav__item> <a href=#pillow class=md-nav__link> <span class=md-ellipsis> 用Pillow处理图像 </span> </a> </li> <li class=md-nav__item> <a href=#pillow_1 class=md-nav__link> <span class=md-ellipsis> 使用Pillow绘图 </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 简单的总结 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#29python class=md-nav__link> <span class=md-ellipsis> 第29课：用Python发送邮件和短信 </span> </a> <nav class=md-nav aria-label=第29课：用Python发送邮件和短信> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> 发送电子邮件 </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> 发送短信 </span> </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> 简单的总结 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/r-z-zhang-AI/r-z-zhang-AI.github.io/edit/main/docs/CS/pl/Python/file-advance.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg> </a> <h1>File advance</h1> <h2 id=csvcsv>csv文件与csv库<a class=headerlink href=#csvcsv title="Permanent link">&para;</a></h2> <h3 id=1-csv><strong>1. 读取 CSV 文件</strong><a class=headerlink href=#1-csv title="Permanent link">&para;</a></h3> <h4 id=1-csvreader><strong>(1) <code>csv.reader</code></strong><a class=headerlink href=#1-csvreader title="Permanent link">&para;</a></h4> <ul> <li><strong>功能</strong>：逐行读取 CSV 文件，返回一个 <code>csv.reader</code> 对象，该对象是一个迭代器，每次迭代返回一行数据（以列表形式）。</li> <li><strong>语法</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=n>csv</span><span class=o>.</span><span class=n>reader</span><span class=p>(</span><span class=n>csvfile</span><span class=p>,</span> <span class=n>dialect</span><span class=o>=</span><span class=s1>&#39;excel&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>fmtparams</span><span class=p>)</span>
</span></code></pre></div></li> <li><strong>参数</strong>：<ul> <li><code>csvfile</code>：文件对象或任何支持迭代的对象。</li> <li><code>dialect</code>：指定 CSV 文件的格式（如 <code>excel</code>、<code>excel-tab</code> 等）。</li> <li><code>fmtparams</code>：其他格式化参数，如 <code>delimiter</code>（分隔符）、<code>quotechar</code>（引用符）等。</li> </ul> </li> </ul> <div class="admonition info"> <p class=admonition-title>方言</p> <p>在 Python 的 <code>csv</code> 库中，<strong>方言（Dialect）</strong> 是指一组用于定义 CSV 文件格式的参数。</p> <p><strong>方言</strong> 将这些格式参数封装在一起，使得在处理不同格式的 CSV 文件时，可以更方便地统一管理这些参数。</p> <p><strong>2. 方言的参数</strong> 方言由一组参数定义，常用的参数包括： - <strong><code>delimiter</code></strong>：字段分隔符，默认为逗号 <code>,</code>。 - <strong><code>quotechar</code></strong>：引用符，用于括起包含特殊字符的字段，默认为双引号 <code>"</code>。 - <strong><code>quoting</code></strong>：引用模式，决定何时使用引用符。可选值： - <code>csv.QUOTE_MINIMAL</code>：仅在必要时使用引用符（默认）。 - <code>csv.QUOTE_ALL</code>：所有字段都用引用符括起。 - <code>csv.QUOTE_NONNUMERIC</code>：所有非数字字段都用引用符括起。 - <code>csv.QUOTE_NONE</code>：不使用引用符。 - <strong><code>lineterminator</code></strong>：行结束符，默认为 <code>\r\n</code>。 - <strong><code>escapechar</code></strong>：转义符，用于转义特殊字符，默认为 <code>None</code>。 - <strong><code>doublequote</code></strong>：是否双写引用符，默认为 <code>True</code>。</p> </div> <ul> <li><strong>示例</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>import</span><span class=w> </span><span class=nn>csv</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;data.csv&#39;</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>newline</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>    <span class=n>reader</span> <span class=o>=</span> <span class=n>csv</span><span class=o>.</span><span class=n>reader</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>    <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>reader</span><span class=p>:</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>        <span class=nb>print</span><span class=p>(</span><span class=n>row</span><span class=p>)</span>
</span></code></pre></div></li> </ul> <h4 id=2-csvdictreader><strong>(2) <code>csv.DictReader</code></strong><a class=headerlink href=#2-csvdictreader title="Permanent link">&para;</a></h4> <ul> <li><strong>功能</strong>：将 CSV 文件的每一行转换为字典形式，字典的键是表头（第一行的列名），值是对应的字段值。</li> <li><strong>语法</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>csv</span><span class=o>.</span><span class=n>DictReader</span><span class=p>(</span><span class=n>csvfile</span><span class=p>,</span> <span class=n>fieldnames</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>restkey</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>restval</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>dialect</span><span class=o>=</span><span class=s1>&#39;excel&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>fmtparams</span><span class=p>)</span>
</span></code></pre></div></li> <li><strong>参数</strong>：<ul> <li><code>csvfile</code>：文件对象或任何支持迭代的对象。</li> <li><code>fieldnames</code>：指定表头（列名）。如果未指定，默认使用第一行作为表头。</li> <li><code>restkey</code>：如果某行的字段多于表头，多余的字段会以 <code>restkey</code> 为键存储。</li> <li><code>restval</code>：如果某行的字段少于表头，缺少的字段会以 <code>restval</code> 为值填充。</li> </ul> </li> <li> <p><strong>示例</strong>： ```python import csv</p> <p>with open('scores.csv', 'r') as file: reader = csv.reader(file, delimiter='|') for data_list in reader: print(reader.line_num, end='\t') for elem in data_list: print(elem, end='\t') print() ```</p> </li> </ul> <hr> <h3 id=2-csv><strong>2. 写入 CSV 文件</strong><a class=headerlink href=#2-csv title="Permanent link">&para;</a></h3> <h4 id=1-csvwriter><strong>(1) <code>csv.writer</code></strong><a class=headerlink href=#1-csvwriter title="Permanent link">&para;</a></h4> <ul> <li><strong>功能</strong>：将数据逐行写入 CSV 文件。</li> <li><strong>语法</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>csv</span><span class=o>.</span><span class=n>writer</span><span class=p>(</span><span class=n>csvfile</span><span class=p>,</span> <span class=n>dialect</span><span class=o>=</span><span class=s1>&#39;excel&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>fmtparams</span><span class=p>)</span>
</span></code></pre></div></li> <li><strong>返回值</strong>：返回一个 <code>csv.writer</code> 对象。</li> <li><strong>参数</strong>：<ul> <li><code>csvfile</code>：文件对象。</li> <li><code>dialect</code>：指定 CSV 文件的格式。</li> <li><code>fmtparams</code>：其他格式化参数，如 <code>delimiter</code>、<code>quotechar</code> 等。</li> </ul> </li> <li> <p><strong>示例</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>import</span><span class=w> </span><span class=nn>csv</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=n>data</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>    <span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>,</span> <span class=s1>&#39;city&#39;</span><span class=p>],</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>    <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;30&#39;</span><span class=p>,</span> <span class=s1>&#39;New York&#39;</span><span class=p>],</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>    <span class=p>[</span><span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;25&#39;</span><span class=p>,</span> <span class=s1>&#39;Los Angeles&#39;</span><span class=p>]</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=p>]</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;output.csv&#39;</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>newline</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>    <span class=n>writer</span> <span class=o>=</span> <span class=n>csv</span><span class=o>.</span><span class=n>writer</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>    <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>        <span class=n>writer</span><span class=o>.</span><span class=n>writerow</span><span class=p>(</span><span class=n>row</span><span class=p>)</span>
</span></code></pre></div> ```python import csv import random</p> <p>with open('scores.csv', 'w') as file: writer = csv.writer(file) writer.writerow(['姓名', '语文', '数学', '英语']) names = ['关羽', '张飞', '赵云', '马超', '黄忠'] for name in names: scores = [random.randrange(50, 101) for _ in range(3)] scores.insert(0, name) writer.writerow(scores) ```</p> </li> </ul> <h4 id=2-csvdictwriter><strong>(2) <code>csv.DictWriter</code></strong><a class=headerlink href=#2-csvdictwriter title="Permanent link">&para;</a></h4> <ul> <li><strong>功能</strong>：将字典形式的数据写入 CSV 文件，需要指定表头。</li> <li><strong>语法</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>csv</span><span class=o>.</span><span class=n>DictWriter</span><span class=p>(</span><span class=n>csvfile</span><span class=p>,</span> <span class=n>fieldnames</span><span class=p>,</span> <span class=n>restval</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>extrasaction</span><span class=o>=</span><span class=s1>&#39;raise&#39;</span><span class=p>,</span> <span class=n>dialect</span><span class=o>=</span><span class=s1>&#39;excel&#39;</span><span class=p>,</span> <span class=o>**</span><span class=n>fmtparams</span><span class=p>)</span>
</span></code></pre></div></li> <li><strong>参数</strong>：<ul> <li><code>csvfile</code>：文件对象。</li> <li><code>fieldnames</code>：表头（列名）。</li> <li><code>restval</code>：如果某行的字段少于表头，缺少的字段会以 <code>restval</code> 为值填充。</li> <li><code>extrasaction</code>：如果某行的字段多于表头，<code>extrasaction</code> 决定如何处理（<code>raise</code> 抛出异常，<code>ignore</code> 忽略多余字段）。</li> </ul> </li> <li><strong>示例</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=kn>import</span><span class=w> </span><span class=nn>csv</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=n>data</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=s1>&#39;30&#39;</span><span class=p>,</span> <span class=s1>&#39;city&#39;</span><span class=p>:</span> <span class=s1>&#39;New York&#39;</span><span class=p>},</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>    <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=s1>&#39;25&#39;</span><span class=p>,</span> <span class=s1>&#39;city&#39;</span><span class=p>:</span> <span class=s1>&#39;Los Angeles&#39;</span><span class=p>}</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=p>]</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=n>headers</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>,</span> <span class=s1>&#39;city&#39;</span><span class=p>]</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;output.csv&#39;</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>newline</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>    <span class=n>writer</span> <span class=o>=</span> <span class=n>csv</span><span class=o>.</span><span class=n>DictWriter</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>fieldnames</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>    <span class=n>writer</span><span class=o>.</span><span class=n>writeheader</span><span class=p>()</span>  <span class=c1># 写入表头</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>    <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>        <span class=n>writer</span><span class=o>.</span><span class=n>writerow</span><span class=p>(</span><span class=n>row</span><span class=p>)</span>
</span></code></pre></div></li> </ul> <hr> <h3 id=3><strong>3. 其他功能</strong><a class=headerlink href=#3 title="Permanent link">&para;</a></h3> <h4 id=1-csvregister_dialect><strong>(1) <code>csv.register_dialect</code></strong><a class=headerlink href=#1-csvregister_dialect title="Permanent link">&para;</a></h4> <ul> <li><strong>功能</strong>：注册一个自定义的 CSV 格式（方言）。</li> <li><strong>语法</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=n>csv</span><span class=o>.</span><span class=n>register_dialect</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=o>**</span><span class=n>fmtparams</span><span class=p>)</span>
</span></code></pre></div></li> <li><strong>参数</strong>：<ul> <li><code>name</code>：方言的名称。</li> <li><code>fmtparams</code>：格式化参数，如 <code>delimiter</code>、<code>quotechar</code> 等。</li> </ul> </li> <li><strong>示例</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=kn>import</span><span class=w> </span><span class=nn>csv</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=n>csv</span><span class=o>.</span><span class=n>register_dialect</span><span class=p>(</span><span class=s1>&#39;my_dialect&#39;</span><span class=p>,</span> <span class=n>delimiter</span><span class=o>=</span><span class=s1>&#39;|&#39;</span><span class=p>,</span> <span class=n>quotechar</span><span class=o>=</span><span class=s1>&#39;&quot;&#39;</span><span class=p>)</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;data.csv&#39;</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>newline</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>    <span class=n>reader</span> <span class=o>=</span> <span class=n>csv</span><span class=o>.</span><span class=n>reader</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>dialect</span><span class=o>=</span><span class=s1>&#39;my_dialect&#39;</span><span class=p>)</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>reader</span><span class=p>:</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>        <span class=nb>print</span><span class=p>(</span><span class=n>row</span><span class=p>)</span>
</span></code></pre></div></li> </ul> <h4 id=2-csvunregister_dialect><strong>(2) <code>csv.unregister_dialect</code></strong><a class=headerlink href=#2-csvunregister_dialect title="Permanent link">&para;</a></h4> <ul> <li><strong>功能</strong>：删除已注册的方言。</li> <li><strong>语法</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>csv</span><span class=o>.</span><span class=n>unregister_dialect</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></code></pre></div></li> <li><strong>示例</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=kn>import</span><span class=w> </span><span class=nn>csv</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=n>csv</span><span class=o>.</span><span class=n>unregister_dialect</span><span class=p>(</span><span class=s1>&#39;my_dialect&#39;</span><span class=p>)</span>
</span></code></pre></div></li> </ul> <h4 id=3-csvlist_dialects><strong>(3) <code>csv.list_dialects</code></strong><a class=headerlink href=#3-csvlist_dialects title="Permanent link">&para;</a></h4> <ul> <li><strong>功能</strong>：返回所有已注册的方言名称。</li> <li><strong>语法</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=n>csv</span><span class=o>.</span><span class=n>list_dialects</span><span class=p>()</span>
</span></code></pre></div></li> <li><strong>示例</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=kn>import</span><span class=w> </span><span class=nn>csv</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=n>dialects</span> <span class=o>=</span> <span class=n>csv</span><span class=o>.</span><span class=n>list_dialects</span><span class=p>()</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=nb>print</span><span class=p>(</span><span class=n>dialects</span><span class=p>)</span>  <span class=c1># 输出：[&#39;excel&#39;, &#39;excel-tab&#39;, &#39;unix&#39;]</span>
</span></code></pre></div></li> </ul> <h4 id=4-csvget_dialect><strong>(4) <code>csv.get_dialect</code></strong><a class=headerlink href=#4-csvget_dialect title="Permanent link">&para;</a></h4> <ul> <li><strong>功能</strong>：获取指定名称的方言对象。</li> <li><strong>语法</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=n>csv</span><span class=o>.</span><span class=n>get_dialect</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></code></pre></div></li> <li><strong>示例</strong>： <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=kn>import</span><span class=w> </span><span class=nn>csv</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=n>dialect</span> <span class=o>=</span> <span class=n>csv</span><span class=o>.</span><span class=n>get_dialect</span><span class=p>(</span><span class=s1>&#39;excel&#39;</span><span class=p>)</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=nb>print</span><span class=p>(</span><span class=n>dialect</span><span class=o>.</span><span class=n>delimiter</span><span class=p>)</span>  <span class=c1># 输出：&#39;,&#39;</span>
</span></code></pre></div></li> </ul> <div class="admonition info"> <p class=admonition-title>Info</p> <p>使用Python做数据分析，很有可能会用到名为pandas的三方库，它是Python数据分析的神器之一。pandas中封装了名为read_csv和to_csv的函数用来读写CSV文件，其中read_CSV会将读取到的数据变成一个DataFrame对象，而DataFrame就是pandas库中最重要的类型，它封装了一系列用于数据处理的方法（清洗、转换、聚合等）；而to_csv会将DataFrame对象中的数据写入CSV文件，完成数据的持久化。read_csv函数和to_csv函数远远比原生的csvreader和csvwriter强大。</p> </div> <h2 id=excel>Excel文件<a class=headerlink href=#excel title="Permanent link">&para;</a></h2> <h3 id=excel_1>Excel简介<a class=headerlink href=#excel_1 title="Permanent link">&para;</a></h3> <p>Excel是Microsoft（微软）为使用Windows和macOS操作系统开发的一款电子表格软件。Excel凭借其直观的界面、出色的计算功能和图表工具，再加上成功的市场营销，一直以来都是最为流行的个人计算机数据处理软件。当然，Excel也有很多竞品，例如Google Sheets、LibreOffice Calc、Numbers等，这些竞品基本上也能够兼容Excel，至少能够读写较新版本的Excel文件，当然这些不是我们讨论的重点。掌握用Python程序操作Excel文件，可以让日常办公自动化的工作更加轻松愉快，而且在很多商业项目中，导入导出Excel文件都是特别常见的功能。</p> <p>Python操作Excel需要三方库的支持，如果要兼容Excel 2007以前的版本，也就是<code>xls</code>格式的Excel文件，可以使用三方库<code>xlrd</code>和<code>xlwt</code>，前者用于读Excel文件，后者用于写Excel文件。如果使用较新版本的Excel，即操作<code>xlsx</code>格式的Excel文件，可以使用<code>openpyxl</code>库，当然这个库不仅仅可以操作Excel，还可以操作其他基于Office Open XML的电子表格文件。</p> <p>本章我们先讲解基于<code>xlwt</code>和<code>xlrd</code>操作Excel文件，大家可以先使用下面的命令安装这两个三方库以及配合使用的工具模块<code>xlutils</code>。</p> <div class="language-Bash highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>pip<span class=w> </span>install<span class=w> </span>xlwt<span class=w> </span>xlrd<span class=w> </span>xlutils
</span></code></pre></div> <h3 id=excel_2>读Excel文件<a class=headerlink href=#excel_2 title="Permanent link">&para;</a></h3> <p>例如在当前文件夹下有一个名为“阿里巴巴2020年股票数据.xls”的Excel文件，如果想读取并显示该文件的内容，可以通过如下所示的代码来完成。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=kn>import</span><span class=w> </span><span class=nn>xlrd</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=c1># 使用xlrd模块的open_workbook函数打开指定Excel文件并获得Book对象（工作簿）</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=o>&lt;</span><span class=n>div</span> <span class=n>markdown</span><span class=o>=</span><span class=s2>&quot;1&quot;</span> <span class=n>style</span><span class=o>=</span><span class=s2>&quot;margin-top: -30px; font-size: 0.75em; opacity: 0.7;&quot;</span><span class=o>&gt;</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=p>:</span><span class=n>material</span><span class=o>-</span><span class=n>circle</span><span class=o>-</span><span class=n>edit</span><span class=o>-</span><span class=n>outline</span><span class=p>:</span> <span class=n>约</span> <span class=mi>6324</span> <span class=n>个字</span> <span class=p>:</span><span class=n>fontawesome</span><span class=o>-</span><span class=n>solid</span><span class=o>-</span><span class=n>code</span><span class=p>:</span> <span class=mi>628</span> <span class=n>行代码</span> <span class=p>:</span><span class=n>material</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>multiple</span><span class=o>-</span><span class=n>outline</span><span class=p>:</span> <span class=mi>14</span> <span class=n>张图片</span> <span class=p>:</span><span class=n>material</span><span class=o>-</span><span class=n>clock</span><span class=o>-</span><span class=n>time</span><span class=o>-</span><span class=n>two</span><span class=o>-</span><span class=n>outline</span><span class=p>:</span> <span class=n>预计阅读时间</span> <span class=mi>29</span> <span class=n>分钟</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=o>&lt;/</span><span class=n>div</span><span class=o>&gt;</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=n>wb</span> <span class=o>=</span> <span class=n>xlrd</span><span class=o>.</span><span class=n>open_workbook</span><span class=p>(</span><span class=s1>&#39;阿里巴巴2020年股票数据.xls&#39;</span><span class=p>)</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=c1># 通过Book对象的sheet_names方法可以获取所有表单名称</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=n>sheetnames</span> <span class=o>=</span> <span class=n>wb</span><span class=o>.</span><span class=n>sheet_names</span><span class=p>()</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=nb>print</span><span class=p>(</span><span class=n>sheetnames</span><span class=p>)</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=c1># 通过指定的表单名称获取Sheet对象（工作表）</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=n>sheet</span> <span class=o>=</span> <span class=n>wb</span><span class=o>.</span><span class=n>sheet_by_name</span><span class=p>(</span><span class=n>sheetnames</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=c1># 通过Sheet对象的nrows和ncols属性获取表单的行数和列数</span>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=nb>print</span><span class=p>(</span><span class=n>sheet</span><span class=o>.</span><span class=n>nrows</span><span class=p>,</span> <span class=n>sheet</span><span class=o>.</span><span class=n>ncols</span><span class=p>)</span>
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>sheet</span><span class=o>.</span><span class=n>nrows</span><span class=p>):</span>
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a>    <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>sheet</span><span class=o>.</span><span class=n>ncols</span><span class=p>):</span>
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a>        <span class=c1># 通过Sheet对象的cell方法获取指定Cell对象（单元格）</span>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>        <span class=c1># 通过Cell对象的value属性获取单元格中的值</span>
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a>        <span class=n>value</span> <span class=o>=</span> <span class=n>sheet</span><span class=o>.</span><span class=n>cell</span><span class=p>(</span><span class=n>row</span><span class=p>,</span> <span class=n>col</span><span class=p>)</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-16-20><a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a>        <span class=c1># 对除首行外的其他行进行数据格式化处理</span>
</span><span id=__span-16-21><a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a>        <span class=k>if</span> <span class=n>row</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-16-22><a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a>            <span class=c1># 第1列的xldate类型先转成元组再格式化为“年月日”的格式</span>
</span><span id=__span-16-23><a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a>            <span class=k>if</span> <span class=n>col</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-16-24><a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a>                <span class=c1># xldate_as_tuple函数的第二个参数只有0和1两个取值</span>
</span><span id=__span-16-25><a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a>                <span class=c1># 其中0代表以1900-01-01为基准的日期，1代表以1904-01-01为基准的日期</span>
</span><span id=__span-16-26><a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a>                <span class=n>value</span> <span class=o>=</span> <span class=n>xlrd</span><span class=o>.</span><span class=n>xldate_as_tuple</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-16-27><a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a>                <span class=n>value</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>value</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s1>年</span><span class=si>{</span><span class=n>value</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s1>&gt;02d</span><span class=si>}</span><span class=s1>月</span><span class=si>{</span><span class=n>value</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>:</span><span class=s1>&gt;02d</span><span class=si>}</span><span class=s1>日&#39;</span>
</span><span id=__span-16-28><a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a>            <span class=c1># 其他列的number类型处理成小数点后保留两位有效数字的浮点数</span>
</span><span id=__span-16-29><a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-16-30><a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a>                <span class=n>value</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>value</span><span class=si>:</span><span class=s1>.2f</span><span class=si>}</span><span class=s1>&#39;</span>
</span><span id=__span-16-31><a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a>        <span class=nb>print</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;</span><span class=se>\t</span><span class=s1>&#39;</span><span class=p>)</span>
</span><span id=__span-16-32><a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a>    <span class=nb>print</span><span class=p>()</span>
</span><span id=__span-16-33><a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a><span class=c1># 获取最后一个单元格的数据类型</span>
</span><span id=__span-16-34><a id=__codelineno-16-34 name=__codelineno-16-34 href=#__codelineno-16-34></a><span class=c1># 0 - 空值，1 - 字符串，2 - 数字，3 - 日期，4 - 布尔，5 - 错误</span>
</span><span id=__span-16-35><a id=__codelineno-16-35 name=__codelineno-16-35 href=#__codelineno-16-35></a><span class=n>last_cell_type</span> <span class=o>=</span> <span class=n>sheet</span><span class=o>.</span><span class=n>cell_type</span><span class=p>(</span><span class=n>sheet</span><span class=o>.</span><span class=n>nrows</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>sheet</span><span class=o>.</span><span class=n>ncols</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-16-36><a id=__codelineno-16-36 name=__codelineno-16-36 href=#__codelineno-16-36></a><span class=nb>print</span><span class=p>(</span><span class=n>last_cell_type</span><span class=p>)</span>
</span><span id=__span-16-37><a id=__codelineno-16-37 name=__codelineno-16-37 href=#__codelineno-16-37></a><span class=c1># 获取第一行的值（列表）</span>
</span><span id=__span-16-38><a id=__codelineno-16-38 name=__codelineno-16-38 href=#__codelineno-16-38></a><span class=nb>print</span><span class=p>(</span><span class=n>sheet</span><span class=o>.</span><span class=n>row_values</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span>
</span><span id=__span-16-39><a id=__codelineno-16-39 name=__codelineno-16-39 href=#__codelineno-16-39></a><span class=c1># 获取指定行指定列范围的数据（列表）</span>
</span><span id=__span-16-40><a id=__codelineno-16-40 name=__codelineno-16-40 href=#__codelineno-16-40></a><span class=c1># 第一个参数代表行索引，第二个和第三个参数代表列的开始（含）和结束（不含）索引</span>
</span><span id=__span-16-41><a id=__codelineno-16-41 name=__codelineno-16-41 href=#__codelineno-16-41></a><span class=nb>print</span><span class=p>(</span><span class=n>sheet</span><span class=o>.</span><span class=n>row_slice</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>
</span></code></pre></div> <blockquote> <p><strong>提示</strong>：上面代码中使用的Excel文件“阿里巴巴2020年股票数据.xls”可以通过后面的百度云盘地址进行获取。链接:<a href=https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g>https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g</a> 提取码:e7b4。</p> </blockquote> <p>相信通过上面的代码，大家已经了解到了如何读取一个Excel文件，如果想知道更多关于<code>xlrd</code>模块的知识，可以阅读它的<a href=https://xlrd.readthedocs.io/en/latest/ >官方文档</a>。</p> <h3 id=excel_3>写Excel文件<a class=headerlink href=#excel_3 title="Permanent link">&para;</a></h3> <p>写入Excel文件可以通过<code>xlwt</code> 模块的<code>Workbook</code>类创建工作簿对象，通过工作簿对象的<code>add_sheet</code>方法可以添加工作表，通过工作表对象的<code>write</code>方法可以向指定单元格中写入数据，最后通过工作簿对象的<code>save</code>方法将工作簿写入到指定的文件或内存中。下面的代码实现了将<code>5</code>个学生<code>3</code>门课程的考试成绩写入Excel文件的操作。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=kn>import</span><span class=w> </span><span class=nn>random</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=kn>import</span><span class=w> </span><span class=nn>xlwt</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=n>student_names</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;关羽&#39;</span><span class=p>,</span> <span class=s1>&#39;张飞&#39;</span><span class=p>,</span> <span class=s1>&#39;赵云&#39;</span><span class=p>,</span> <span class=s1>&#39;马超&#39;</span><span class=p>,</span> <span class=s1>&#39;黄忠&#39;</span><span class=p>]</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=n>scores</span> <span class=o>=</span> <span class=p>[[</span><span class=n>random</span><span class=o>.</span><span class=n>randrange</span><span class=p>(</span><span class=mi>50</span><span class=p>,</span> <span class=mi>101</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>)]</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=c1># 创建工作簿对象（Workbook）</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=n>wb</span> <span class=o>=</span> <span class=n>xlwt</span><span class=o>.</span><span class=n>Workbook</span><span class=p>()</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=c1># 创建工作表对象（Worksheet）</span>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=n>sheet</span> <span class=o>=</span> <span class=n>wb</span><span class=o>.</span><span class=n>add_sheet</span><span class=p>(</span><span class=s1>&#39;一年级二班&#39;</span><span class=p>)</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=c1># 添加表头数据</span>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=n>titles</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;姓名&#39;</span><span class=p>,</span> <span class=s1>&#39;语文&#39;</span><span class=p>,</span> <span class=s1>&#39;数学&#39;</span><span class=p>,</span> <span class=s1>&#39;英语&#39;</span><span class=p>)</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=k>for</span> <span class=n>index</span><span class=p>,</span> <span class=n>title</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>titles</span><span class=p>):</span>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>    <span class=n>sheet</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>index</span><span class=p>,</span> <span class=n>title</span><span class=p>)</span>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a><span class=c1># 将学生姓名和考试成绩写入单元格</span>
</span><span id=__span-17-16><a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a><span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>scores</span><span class=p>)):</span>
</span><span id=__span-17-17><a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a>    <span class=n>sheet</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>row</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>student_names</span><span class=p>[</span><span class=n>row</span><span class=p>])</span>
</span><span id=__span-17-18><a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a>    <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>scores</span><span class=p>[</span><span class=n>row</span><span class=p>])):</span>
</span><span id=__span-17-19><a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a>        <span class=n>sheet</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>row</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>col</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>scores</span><span class=p>[</span><span class=n>row</span><span class=p>][</span><span class=n>col</span><span class=p>])</span>
</span><span id=__span-17-20><a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a><span class=c1># 保存Excel工作簿</span>
</span><span id=__span-17-21><a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a><span class=n>wb</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s1>&#39;考试成绩表.xls&#39;</span><span class=p>)</span>
</span></code></pre></div> <h4 id=_1>调整单元格样式<a class=headerlink href=#_1 title="Permanent link">&para;</a></h4> <p>在写Excel文件时，我们还可以为单元格设置样式，主要包括字体（Font）、对齐方式（Alignment）、边框（Border）和背景（Background）的设置，<code>xlwt</code>对这几项设置都封装了对应的类来支持。要设置单元格样式需要首先创建一个<code>XFStyle</code>对象，再通过该对象的属性对字体、对齐方式、边框等进行设定，例如在上面的例子中，如果希望将表头单元格的背景色修改为黄色，可以按照如下的方式进行操作。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=n>header_style</span> <span class=o>=</span> <span class=n>xlwt</span><span class=o>.</span><span class=n>XFStyle</span><span class=p>()</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=n>pattern</span> <span class=o>=</span> <span class=n>xlwt</span><span class=o>.</span><span class=n>Pattern</span><span class=p>()</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=n>pattern</span><span class=o>.</span><span class=n>pattern</span> <span class=o>=</span> <span class=n>xlwt</span><span class=o>.</span><span class=n>Pattern</span><span class=o>.</span><span class=n>SOLID_PATTERN</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=c1># 0 - 黑色、1 - 白色、2 - 红色、3 - 绿色、4 - 蓝色、5 - 黄色、6 - 粉色、7 - 青色</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=n>pattern</span><span class=o>.</span><span class=n>pattern_fore_colour</span> <span class=o>=</span> <span class=mi>5</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=n>header_style</span><span class=o>.</span><span class=n>pattern</span> <span class=o>=</span> <span class=n>pattern</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=n>titles</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;姓名&#39;</span><span class=p>,</span> <span class=s1>&#39;语文&#39;</span><span class=p>,</span> <span class=s1>&#39;数学&#39;</span><span class=p>,</span> <span class=s1>&#39;英语&#39;</span><span class=p>)</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=k>for</span> <span class=n>index</span><span class=p>,</span> <span class=n>title</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>titles</span><span class=p>):</span>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a>    <span class=n>sheet</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>index</span><span class=p>,</span> <span class=n>title</span><span class=p>,</span> <span class=n>header_style</span><span class=p>)</span>
</span></code></pre></div> <p>如果希望为表头设置指定的字体，可以使用<code>Font</code>类并添加如下所示的代码。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=n>font</span> <span class=o>=</span> <span class=n>xlwt</span><span class=o>.</span><span class=n>Font</span><span class=p>()</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=c1># 字体名称</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=n>font</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;华文楷体&#39;</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=c1># 字体大小（20是基准单位，18表示18px）</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=n>font</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=mi>20</span> <span class=o>*</span> <span class=mi>18</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=c1># 是否使用粗体</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=n>font</span><span class=o>.</span><span class=n>bold</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=c1># 是否使用斜体</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=n>font</span><span class=o>.</span><span class=n>italic</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=c1># 字体颜色</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=n>font</span><span class=o>.</span><span class=n>colour_index</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=n>header_style</span><span class=o>.</span><span class=n>font</span> <span class=o>=</span> <span class=n>font</span>
</span></code></pre></div> <blockquote> <p><strong>注意</strong>：上面代码中指定的字体名（<code>font.name</code>）应当是本地系统有的字体，例如在我的电脑上有名为“华文楷体”的字体。</p> </blockquote> <p>如果希望表头垂直居中对齐，可以使用下面的代码进行设置。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=n>align</span> <span class=o>=</span> <span class=n>xlwt</span><span class=o>.</span><span class=n>Alignment</span><span class=p>()</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=c1># 垂直方向的对齐方式</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=n>align</span><span class=o>.</span><span class=n>vert</span> <span class=o>=</span> <span class=n>xlwt</span><span class=o>.</span><span class=n>Alignment</span><span class=o>.</span><span class=n>VERT_CENTER</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=c1># 水平方向的对齐方式</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=n>align</span><span class=o>.</span><span class=n>horz</span> <span class=o>=</span> <span class=n>xlwt</span><span class=o>.</span><span class=n>Alignment</span><span class=o>.</span><span class=n>HORZ_CENTER</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=n>header_style</span><span class=o>.</span><span class=n>alignment</span> <span class=o>=</span> <span class=n>align</span>
</span></code></pre></div> <p>如果希望给表头加上黄色的虚线边框，可以使用下面的代码来设置。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=n>borders</span> <span class=o>=</span> <span class=n>xlwt</span><span class=o>.</span><span class=n>Borders</span><span class=p>()</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=n>props</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>    <span class=p>(</span><span class=s1>&#39;top&#39;</span><span class=p>,</span> <span class=s1>&#39;top_colour&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;right&#39;</span><span class=p>,</span> <span class=s1>&#39;right_colour&#39;</span><span class=p>),</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>    <span class=p>(</span><span class=s1>&#39;bottom&#39;</span><span class=p>,</span> <span class=s1>&#39;bottom_colour&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;left&#39;</span><span class=p>,</span> <span class=s1>&#39;left_colour&#39;</span><span class=p>)</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=p>)</span>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=c1># 通过循环对四个方向的边框样式及颜色进行设定</span>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=k>for</span> <span class=n>position</span><span class=p>,</span> <span class=n>color</span> <span class=ow>in</span> <span class=n>props</span><span class=p>:</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>    <span class=c1># 使用setattr内置函数动态给对象指定的属性赋值</span>
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>    <span class=nb>setattr</span><span class=p>(</span><span class=n>borders</span><span class=p>,</span> <span class=n>position</span><span class=p>,</span> <span class=n>xlwt</span><span class=o>.</span><span class=n>Borders</span><span class=o>.</span><span class=n>DASHED</span><span class=p>)</span>
</span><span id=__span-21-10><a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>    <span class=nb>setattr</span><span class=p>(</span><span class=n>borders</span><span class=p>,</span> <span class=n>color</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span><span id=__span-21-11><a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a><span class=n>header_style</span><span class=o>.</span><span class=n>borders</span> <span class=o>=</span> <span class=n>borders</span>
</span></code></pre></div> <p>如果要调整单元格的宽度（列宽）和表头的高度（行高），可以按照下面的代码进行操作。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=c1># 设置行高为40px</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=n>sheet</span><span class=o>.</span><span class=n>row</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>set_style</span><span class=p>(</span><span class=n>xlwt</span><span class=o>.</span><span class=n>easyxf</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;font:height </span><span class=si>{</span><span class=mi>20</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>40</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>))</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=n>titles</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;姓名&#39;</span><span class=p>,</span> <span class=s1>&#39;语文&#39;</span><span class=p>,</span> <span class=s1>&#39;数学&#39;</span><span class=p>,</span> <span class=s1>&#39;英语&#39;</span><span class=p>)</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=k>for</span> <span class=n>index</span><span class=p>,</span> <span class=n>title</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>titles</span><span class=p>):</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>    <span class=c1># 设置列宽为200px</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>    <span class=n>sheet</span><span class=o>.</span><span class=n>col</span><span class=p>(</span><span class=n>index</span><span class=p>)</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=mi>20</span> <span class=o>*</span> <span class=mi>200</span>
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a>    <span class=c1># 设置单元格的数据和样式</span>
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>    <span class=n>sheet</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>index</span><span class=p>,</span> <span class=n>title</span><span class=p>,</span> <span class=n>header_style</span><span class=p>)</span>
</span></code></pre></div> <h4 id=_2>公式计算<a class=headerlink href=#_2 title="Permanent link">&para;</a></h4> <p>对于前面打开的“阿里巴巴2020年股票数据.xls”文件，如果要统计全年收盘价（Close字段）的平均值以及全年交易量（Volume字段）的总和，可以使用Excel的公式计算即可。我们可以先使用<code>xlrd</code>读取Excel文件夹，然后通过<code>xlutils</code>三方库提供的<code>copy</code>函数将读取到的Excel文件转成<code>Workbook</code>对象进行写操作，在调用<code>write</code>方法时，可以将一个<code>Formula</code>对象写入单元格。</p> <p>实现公式计算的代码如下所示。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=kn>import</span><span class=w> </span><span class=nn>xlrd</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=kn>import</span><span class=w> </span><span class=nn>xlwt</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=kn>from</span><span class=w> </span><span class=nn>xlutils.copy</span><span class=w> </span><span class=kn>import</span> <span class=n>copy</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=n>wb_for_read</span> <span class=o>=</span> <span class=n>xlrd</span><span class=o>.</span><span class=n>open_workbook</span><span class=p>(</span><span class=s1>&#39;阿里巴巴2020年股票数据.xls&#39;</span><span class=p>)</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=n>sheet1</span> <span class=o>=</span> <span class=n>wb_for_read</span><span class=o>.</span><span class=n>sheet_by_index</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=n>nrows</span><span class=p>,</span> <span class=n>ncols</span> <span class=o>=</span> <span class=n>sheet1</span><span class=o>.</span><span class=n>nrows</span><span class=p>,</span> <span class=n>sheet1</span><span class=o>.</span><span class=n>ncols</span>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=n>wb_for_write</span> <span class=o>=</span> <span class=n>copy</span><span class=p>(</span><span class=n>wb_for_read</span><span class=p>)</span>
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=n>sheet2</span> <span class=o>=</span> <span class=n>wb_for_write</span><span class=o>.</span><span class=n>get_sheet</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=n>sheet2</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>nrows</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=n>xlwt</span><span class=o>.</span><span class=n>Formula</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;average(E2:E</span><span class=si>{</span><span class=n>nrows</span><span class=si>}</span><span class=s1>)&#39;</span><span class=p>))</span>
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a><span class=n>sheet2</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>nrows</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=n>xlwt</span><span class=o>.</span><span class=n>Formula</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;sum(G2:G</span><span class=si>{</span><span class=n>nrows</span><span class=si>}</span><span class=s1>)&#39;</span><span class=p>))</span>
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a><span class=n>wb_for_write</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s1>&#39;阿里巴巴2020年股票数据汇总.xls&#39;</span><span class=p>)</span>
</span></code></pre></div> <blockquote> <p><strong>说明</strong>：上面的代码有一些小瑕疵，有兴趣的读者可以自行探索并思考如何解决。</p> </blockquote> <h3 id=_3>简单的总结<a class=headerlink href=#_3 title="Permanent link">&para;</a></h3> <p>掌握了Python程序操作Excel的方法，可以解决日常办公中很多繁琐的处理Excel电子表格工作，最常见就是将多个数据格式相同的Excel文件合并到一个文件以及从多个Excel文件或表单中提取指定的数据。当然，如果要对表格数据进行处理，使用Python数据分析神器之一的<code>pandas</code>库可能更为方便。</p> <h2 id=25pythonexcel-2>第25课：用Python读写Excel文件-2<a class=headerlink href=#25pythonexcel-2 title="Permanent link">&para;</a></h2> <h3 id=excel_4>Excel简介<a class=headerlink href=#excel_4 title="Permanent link">&para;</a></h3> <p>Excel是Microsoft（微软）为使用Windows和macOS操作系统开发的一款电子表格软件。Excel凭借其直观的界面、出色的计算功能和图表工具，再加上成功的市场营销，一直以来都是最为流行的个人计算机数据处理软件。当然，Excel也有很多竞品，例如Google Sheets、LibreOffice Calc、Numbers等，这些竞品基本上也能够兼容Excel，至少能够读写较新版本的Excel文件，当然这些不是我们讨论的重点。掌握用Python程序操作Excel文件，可以让日常办公自动化的工作更加轻松愉快，而且在很多商业项目中，导入导出Excel文件都是特别常见的功能。</p> <p>本章我们继续讲解基于另一个三方库<code>openpyxl</code>如何进行Excel文件操作，首先需要先安装它。</p> <div class="language-Bash highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a>pip<span class=w> </span>install<span class=w> </span>openpyxl
</span></code></pre></div> <p><code>openpyxl</code>的优点在于，当我们打开一个Excel文件后，既可以对它进行读操作，又可以对它进行写操作，而且在操作的便捷性上是优于<code>xlwt</code>和<code>xlrd</code>的。此外，如果要进行样式编辑和公式计算，使用<code>openpyxl</code>也远比上一个章节我们讲解的方式更为简单，而且<code>openpyxl</code>还支持数据透视和插入图表等操作，功能非常强大。有一点需要再次强调，<code>openpyxl</code>并不支持操作Office 2007以前版本的Excel文件。</p> <h3 id=excel_5>读取Excel文件<a class=headerlink href=#excel_5 title="Permanent link">&para;</a></h3> <p>例如在当前文件夹下有一个名为“阿里巴巴2020年股票数据.xlsx”的Excel文件，如果想读取并显示该文件的内容，可以通过如下所示的代码来完成。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=kn>import</span><span class=w> </span><span class=nn>datetime</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=kn>import</span><span class=w> </span><span class=nn>openpyxl</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=c1># 加载一个工作簿 ---&gt; Workbook</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=n>wb</span> <span class=o>=</span> <span class=n>openpyxl</span><span class=o>.</span><span class=n>load_workbook</span><span class=p>(</span><span class=s1>&#39;阿里巴巴2020年股票数据.xlsx&#39;</span><span class=p>)</span>
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=c1># 获取工作表的名字</span>
</span><span id=__span-25-8><a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=nb>print</span><span class=p>(</span><span class=n>wb</span><span class=o>.</span><span class=n>sheetnames</span><span class=p>)</span>
</span><span id=__span-25-9><a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=c1># 获取工作表 ---&gt; Worksheet</span>
</span><span id=__span-25-10><a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a><span class=n>sheet</span> <span class=o>=</span> <span class=n>wb</span><span class=o>.</span><span class=n>worksheets</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-25-11><a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a><span class=c1># 获得单元格的范围</span>
</span><span id=__span-25-12><a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a><span class=nb>print</span><span class=p>(</span><span class=n>sheet</span><span class=o>.</span><span class=n>dimensions</span><span class=p>)</span>
</span><span id=__span-25-13><a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a><span class=c1># 获得行数和列数</span>
</span><span id=__span-25-14><a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a><span class=nb>print</span><span class=p>(</span><span class=n>sheet</span><span class=o>.</span><span class=n>max_row</span><span class=p>,</span> <span class=n>sheet</span><span class=o>.</span><span class=n>max_column</span><span class=p>)</span>
</span><span id=__span-25-15><a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a>
</span><span id=__span-25-16><a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a><span class=c1># 获取指定单元格的值</span>
</span><span id=__span-25-17><a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a><span class=nb>print</span><span class=p>(</span><span class=n>sheet</span><span class=o>.</span><span class=n>cell</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-25-18><a id=__codelineno-25-18 name=__codelineno-25-18 href=#__codelineno-25-18></a><span class=nb>print</span><span class=p>(</span><span class=n>sheet</span><span class=p>[</span><span class=s1>&#39;C3&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-25-19><a id=__codelineno-25-19 name=__codelineno-25-19 href=#__codelineno-25-19></a><span class=nb>print</span><span class=p>(</span><span class=n>sheet</span><span class=p>[</span><span class=s1>&#39;G255&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-25-20><a id=__codelineno-25-20 name=__codelineno-25-20 href=#__codelineno-25-20></a>
</span><span id=__span-25-21><a id=__codelineno-25-21 name=__codelineno-25-21 href=#__codelineno-25-21></a><span class=c1># 获取多个单元格（嵌套元组）</span>
</span><span id=__span-25-22><a id=__codelineno-25-22 name=__codelineno-25-22 href=#__codelineno-25-22></a><span class=nb>print</span><span class=p>(</span><span class=n>sheet</span><span class=p>[</span><span class=s1>&#39;A2:C5&#39;</span><span class=p>])</span>
</span><span id=__span-25-23><a id=__codelineno-25-23 name=__codelineno-25-23 href=#__codelineno-25-23></a>
</span><span id=__span-25-24><a id=__codelineno-25-24 name=__codelineno-25-24 href=#__codelineno-25-24></a><span class=c1># 读取所有单元格的数据</span>
</span><span id=__span-25-25><a id=__codelineno-25-25 name=__codelineno-25-25 href=#__codelineno-25-25></a><span class=k>for</span> <span class=n>row_ch</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>sheet</span><span class=o>.</span><span class=n>max_row</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span><span id=__span-25-26><a id=__codelineno-25-26 name=__codelineno-25-26 href=#__codelineno-25-26></a>    <span class=k>for</span> <span class=n>col_ch</span> <span class=ow>in</span> <span class=s1>&#39;ABCDEFG&#39;</span><span class=p>:</span>
</span><span id=__span-25-27><a id=__codelineno-25-27 name=__codelineno-25-27 href=#__codelineno-25-27></a>        <span class=n>value</span> <span class=o>=</span> <span class=n>sheet</span><span class=p>[</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>col_ch</span><span class=si>}{</span><span class=n>row_ch</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>value</span>
</span><span id=__span-25-28><a id=__codelineno-25-28 name=__codelineno-25-28 href=#__codelineno-25-28></a>        <span class=k>if</span> <span class=nb>type</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=o>==</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=p>:</span>
</span><span id=__span-25-29><a id=__codelineno-25-29 name=__codelineno-25-29 href=#__codelineno-25-29></a>            <span class=nb>print</span><span class=p>(</span><span class=n>value</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y年%m月</span><span class=si>%d</span><span class=s1>日&#39;</span><span class=p>),</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;</span><span class=se>\t</span><span class=s1>&#39;</span><span class=p>)</span>
</span><span id=__span-25-30><a id=__codelineno-25-30 name=__codelineno-25-30 href=#__codelineno-25-30></a>        <span class=k>elif</span> <span class=nb>type</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=o>==</span> <span class=nb>int</span><span class=p>:</span>
</span><span id=__span-25-31><a id=__codelineno-25-31 name=__codelineno-25-31 href=#__codelineno-25-31></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>value</span><span class=si>:</span><span class=s1>&lt;10d</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;</span><span class=se>\t</span><span class=s1>&#39;</span><span class=p>)</span>
</span><span id=__span-25-32><a id=__codelineno-25-32 name=__codelineno-25-32 href=#__codelineno-25-32></a>        <span class=k>elif</span> <span class=nb>type</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=o>==</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-25-33><a id=__codelineno-25-33 name=__codelineno-25-33 href=#__codelineno-25-33></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>value</span><span class=si>:</span><span class=s1>.4f</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;</span><span class=se>\t</span><span class=s1>&#39;</span><span class=p>)</span>
</span><span id=__span-25-34><a id=__codelineno-25-34 name=__codelineno-25-34 href=#__codelineno-25-34></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-25-35><a id=__codelineno-25-35 name=__codelineno-25-35 href=#__codelineno-25-35></a>            <span class=nb>print</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;</span><span class=se>\t</span><span class=s1>&#39;</span><span class=p>)</span>
</span><span id=__span-25-36><a id=__codelineno-25-36 name=__codelineno-25-36 href=#__codelineno-25-36></a>    <span class=nb>print</span><span class=p>()</span>
</span></code></pre></div> <blockquote> <p><strong>提示</strong>：上面代码中使用的Excel文件“阿里巴巴2020年股票数据.xlsx”可以通过后面的百度云盘地址进行获取。链接:<a href=https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g>https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g</a> 提取码:e7b4。</p> </blockquote> <p>需要提醒大家一点，<code>openpyxl</code>获取指定的单元格有两种方式，一种是通过<code>cell</code>方法，需要注意，该方法的行索引和列索引都是从<code>1</code>开始的，这是为了照顾用惯了Excel的人的习惯；另一种是通过索引运算，通过指定单元格的坐标，例如<code>C3</code>、<code>G255</code>，也可以取得对应的单元格，再通过单元格对象的<code>value</code>属性，就可以获取到单元格的值。通过上面的代码，相信大家还注意到了，可以通过类似<code>sheet['A2:C5']</code>或<code>sheet['A2':'C5']</code>这样的切片操作获取多个单元格，该操作将返回嵌套的元组，相当于获取到了多行多列。</p> <h3 id=excel_6>写Excel文件<a class=headerlink href=#excel_6 title="Permanent link">&para;</a></h3> <p>下面我们使用<code>openpyxl</code>来进行写Excel操作。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=kn>import</span><span class=w> </span><span class=nn>random</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=kn>import</span><span class=w> </span><span class=nn>openpyxl</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=c1># 第一步：创建工作簿（Workbook）</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=n>wb</span> <span class=o>=</span> <span class=n>openpyxl</span><span class=o>.</span><span class=n>Workbook</span><span class=p>()</span>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=c1># 第二步：添加工作表（Worksheet）</span>
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=n>sheet</span> <span class=o>=</span> <span class=n>wb</span><span class=o>.</span><span class=n>active</span>
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=n>sheet</span><span class=o>.</span><span class=n>title</span> <span class=o>=</span> <span class=s1>&#39;期末成绩&#39;</span>
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a>
</span><span id=__span-26-12><a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a><span class=n>titles</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;姓名&#39;</span><span class=p>,</span> <span class=s1>&#39;语文&#39;</span><span class=p>,</span> <span class=s1>&#39;数学&#39;</span><span class=p>,</span> <span class=s1>&#39;英语&#39;</span><span class=p>)</span>
</span><span id=__span-26-13><a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=k>for</span> <span class=n>col_index</span><span class=p>,</span> <span class=n>title</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>titles</span><span class=p>):</span>
</span><span id=__span-26-14><a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a>    <span class=n>sheet</span><span class=o>.</span><span class=n>cell</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>col_index</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>title</span><span class=p>)</span>
</span><span id=__span-26-15><a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a>
</span><span id=__span-26-16><a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a><span class=n>names</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;关羽&#39;</span><span class=p>,</span> <span class=s1>&#39;张飞&#39;</span><span class=p>,</span> <span class=s1>&#39;赵云&#39;</span><span class=p>,</span> <span class=s1>&#39;马超&#39;</span><span class=p>,</span> <span class=s1>&#39;黄忠&#39;</span><span class=p>)</span>
</span><span id=__span-26-17><a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a><span class=k>for</span> <span class=n>row_index</span><span class=p>,</span> <span class=n>name</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>names</span><span class=p>):</span>
</span><span id=__span-26-18><a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a>    <span class=n>sheet</span><span class=o>.</span><span class=n>cell</span><span class=p>(</span><span class=n>row_index</span> <span class=o>+</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
</span><span id=__span-26-19><a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a>    <span class=k>for</span> <span class=n>col_index</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>):</span>
</span><span id=__span-26-20><a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a>        <span class=n>sheet</span><span class=o>.</span><span class=n>cell</span><span class=p>(</span><span class=n>row_index</span> <span class=o>+</span> <span class=mi>2</span><span class=p>,</span> <span class=n>col_index</span><span class=p>,</span> <span class=n>random</span><span class=o>.</span><span class=n>randrange</span><span class=p>(</span><span class=mi>50</span><span class=p>,</span> <span class=mi>101</span><span class=p>))</span>
</span><span id=__span-26-21><a id=__codelineno-26-21 name=__codelineno-26-21 href=#__codelineno-26-21></a>
</span><span id=__span-26-22><a id=__codelineno-26-22 name=__codelineno-26-22 href=#__codelineno-26-22></a><span class=c1># 第四步：保存工作簿</span>
</span><span id=__span-26-23><a id=__codelineno-26-23 name=__codelineno-26-23 href=#__codelineno-26-23></a><span class=n>wb</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s1>&#39;考试成绩表.xlsx&#39;</span><span class=p>)</span>
</span></code></pre></div> <h4 id=_4>调整样式和公式计算<a class=headerlink href=#_4 title="Permanent link">&para;</a></h4> <p>在使用<code>openpyxl</code>操作Excel时，如果要调整单元格的样式，可以直接通过单元格对象（<code>Cell</code>对象）的属性进行操作。单元格对象的属性包括字体（<code>font</code>）、对齐（<code>alignment</code>）、边框（<code>border</code>）等，具体的可以参考<code>openpyxl</code>的<a href=https://openpyxl.readthedocs.io/en/stable/index.html>官方文档</a>。在使用<code>openpyxl</code>时，如果需要做公式计算，可以完全按照Excel中的操作方式来进行，具体的代码如下所示。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=kn>import</span><span class=w> </span><span class=nn>openpyxl</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=kn>from</span><span class=w> </span><span class=nn>openpyxl.styles</span><span class=w> </span><span class=kn>import</span> <span class=n>Font</span><span class=p>,</span> <span class=n>Alignment</span><span class=p>,</span> <span class=n>Border</span><span class=p>,</span> <span class=n>Side</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=c1># 对齐方式</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=n>alignment</span> <span class=o>=</span> <span class=n>Alignment</span><span class=p>(</span><span class=n>horizontal</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=n>vertical</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>)</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=c1># 边框线条</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a><span class=n>side</span> <span class=o>=</span> <span class=n>Side</span><span class=p>(</span><span class=n>color</span><span class=o>=</span><span class=s1>&#39;ff7f50&#39;</span><span class=p>,</span> <span class=n>style</span><span class=o>=</span><span class=s1>&#39;mediumDashed&#39;</span><span class=p>)</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=n>wb</span> <span class=o>=</span> <span class=n>openpyxl</span><span class=o>.</span><span class=n>load_workbook</span><span class=p>(</span><span class=s1>&#39;考试成绩表.xlsx&#39;</span><span class=p>)</span>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=n>sheet</span> <span class=o>=</span> <span class=n>wb</span><span class=o>.</span><span class=n>worksheets</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-27-11><a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a>
</span><span id=__span-27-12><a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a><span class=c1># 调整行高和列宽</span>
</span><span id=__span-27-13><a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a><span class=n>sheet</span><span class=o>.</span><span class=n>row_dimensions</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>height</span> <span class=o>=</span> <span class=mi>30</span>
</span><span id=__span-27-14><a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a><span class=n>sheet</span><span class=o>.</span><span class=n>column_dimensions</span><span class=p>[</span><span class=s1>&#39;E&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>width</span> <span class=o>=</span> <span class=mi>120</span>
</span><span id=__span-27-15><a id=__codelineno-27-15 name=__codelineno-27-15 href=#__codelineno-27-15></a>
</span><span id=__span-27-16><a id=__codelineno-27-16 name=__codelineno-27-16 href=#__codelineno-27-16></a><span class=n>sheet</span><span class=p>[</span><span class=s1>&#39;E1&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;平均分&#39;</span>
</span><span id=__span-27-17><a id=__codelineno-27-17 name=__codelineno-27-17 href=#__codelineno-27-17></a><span class=c1># 设置字体</span>
</span><span id=__span-27-18><a id=__codelineno-27-18 name=__codelineno-27-18 href=#__codelineno-27-18></a><span class=n>sheet</span><span class=o>.</span><span class=n>cell</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>font</span> <span class=o>=</span> <span class=n>Font</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>18</span><span class=p>,</span> <span class=n>bold</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;ff1493&#39;</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;华文楷体&#39;</span><span class=p>)</span>
</span><span id=__span-27-19><a id=__codelineno-27-19 name=__codelineno-27-19 href=#__codelineno-27-19></a><span class=c1># 设置对齐方式</span>
</span><span id=__span-27-20><a id=__codelineno-27-20 name=__codelineno-27-20 href=#__codelineno-27-20></a><span class=n>sheet</span><span class=o>.</span><span class=n>cell</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>alignment</span> <span class=o>=</span> <span class=n>alignment</span>
</span><span id=__span-27-21><a id=__codelineno-27-21 name=__codelineno-27-21 href=#__codelineno-27-21></a><span class=c1># 设置单元格边框</span>
</span><span id=__span-27-22><a id=__codelineno-27-22 name=__codelineno-27-22 href=#__codelineno-27-22></a><span class=n>sheet</span><span class=o>.</span><span class=n>cell</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>border</span> <span class=o>=</span> <span class=n>Border</span><span class=p>(</span><span class=n>left</span><span class=o>=</span><span class=n>side</span><span class=p>,</span> <span class=n>top</span><span class=o>=</span><span class=n>side</span><span class=p>,</span> <span class=n>right</span><span class=o>=</span><span class=n>side</span><span class=p>,</span> <span class=n>bottom</span><span class=o>=</span><span class=n>side</span><span class=p>)</span>
</span><span id=__span-27-23><a id=__codelineno-27-23 name=__codelineno-27-23 href=#__codelineno-27-23></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>7</span><span class=p>):</span>
</span><span id=__span-27-24><a id=__codelineno-27-24 name=__codelineno-27-24 href=#__codelineno-27-24></a>    <span class=c1># 公式计算每个学生的平均分</span>
</span><span id=__span-27-25><a id=__codelineno-27-25 name=__codelineno-27-25 href=#__codelineno-27-25></a>    <span class=n>sheet</span><span class=p>[</span><span class=sa>f</span><span class=s1>&#39;E</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;=average(B</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>:D</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>)&#39;</span>
</span><span id=__span-27-26><a id=__codelineno-27-26 name=__codelineno-27-26 href=#__codelineno-27-26></a>    <span class=n>sheet</span><span class=o>.</span><span class=n>cell</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>font</span> <span class=o>=</span> <span class=n>Font</span><span class=p>(</span><span class=n>size</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;4169e1&#39;</span><span class=p>,</span> <span class=n>italic</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-27-27><a id=__codelineno-27-27 name=__codelineno-27-27 href=#__codelineno-27-27></a>    <span class=n>sheet</span><span class=o>.</span><span class=n>cell</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>alignment</span> <span class=o>=</span> <span class=n>alignment</span>
</span><span id=__span-27-28><a id=__codelineno-27-28 name=__codelineno-27-28 href=#__codelineno-27-28></a>
</span><span id=__span-27-29><a id=__codelineno-27-29 name=__codelineno-27-29 href=#__codelineno-27-29></a><span class=n>wb</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s1>&#39;考试成绩表.xlsx&#39;</span><span class=p>)</span>
</span></code></pre></div> <h3 id=_5>生成统计图表<a class=headerlink href=#_5 title="Permanent link">&para;</a></h3> <p>通过<code>openpyxl</code>库，可以直接向Excel中插入统计图表，具体的做法跟在Excel中插入图表大体一致。我们可以创建指定类型的图表对象，然后通过该对象的属性对图表进行设置。当然，最为重要的是为图表绑定数据，即横轴代表什么，纵轴代表什么，具体的数值是多少。最后，可以将图表对象添加到表单中，具体的代码如下所示。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=kn>from</span><span class=w> </span><span class=nn>openpyxl</span><span class=w> </span><span class=kn>import</span> <span class=n>Workbook</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=kn>from</span><span class=w> </span><span class=nn>openpyxl.chart</span><span class=w> </span><span class=kn>import</span> <span class=n>BarChart</span><span class=p>,</span> <span class=n>Reference</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=n>wb</span> <span class=o>=</span> <span class=n>Workbook</span><span class=p>(</span><span class=n>write_only</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=n>sheet</span> <span class=o>=</span> <span class=n>wb</span><span class=o>.</span><span class=n>create_sheet</span><span class=p>()</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=n>rows</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>    <span class=p>(</span><span class=s1>&#39;类别&#39;</span><span class=p>,</span> <span class=s1>&#39;销售A组&#39;</span><span class=p>,</span> <span class=s1>&#39;销售B组&#39;</span><span class=p>),</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>    <span class=p>(</span><span class=s1>&#39;手机&#39;</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>30</span><span class=p>),</span>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>    <span class=p>(</span><span class=s1>&#39;平板&#39;</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>60</span><span class=p>),</span>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>    <span class=p>(</span><span class=s1>&#39;笔记本&#39;</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>70</span><span class=p>),</span>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a>    <span class=p>(</span><span class=s1>&#39;外围设备&#39;</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>10</span><span class=p>),</span>
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a><span class=p>]</span>
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a>
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a><span class=c1># 向表单中添加行</span>
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a><span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>rows</span><span class=p>:</span>
</span><span id=__span-28-17><a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a>    <span class=n>sheet</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>row</span><span class=p>)</span>
</span><span id=__span-28-18><a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a>
</span><span id=__span-28-19><a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a><span class=c1># 创建图表对象</span>
</span><span id=__span-28-20><a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a><span class=n>chart</span> <span class=o>=</span> <span class=n>BarChart</span><span class=p>()</span>
</span><span id=__span-28-21><a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a><span class=n>chart</span><span class=o>.</span><span class=n>type</span> <span class=o>=</span> <span class=s1>&#39;col&#39;</span>
</span><span id=__span-28-22><a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a><span class=n>chart</span><span class=o>.</span><span class=n>style</span> <span class=o>=</span> <span class=mi>10</span>
</span><span id=__span-28-23><a id=__codelineno-28-23 name=__codelineno-28-23 href=#__codelineno-28-23></a><span class=c1># 设置图表的标题</span>
</span><span id=__span-28-24><a id=__codelineno-28-24 name=__codelineno-28-24 href=#__codelineno-28-24></a><span class=n>chart</span><span class=o>.</span><span class=n>title</span> <span class=o>=</span> <span class=s1>&#39;销售统计图&#39;</span>
</span><span id=__span-28-25><a id=__codelineno-28-25 name=__codelineno-28-25 href=#__codelineno-28-25></a><span class=c1># 设置图表纵轴的标题</span>
</span><span id=__span-28-26><a id=__codelineno-28-26 name=__codelineno-28-26 href=#__codelineno-28-26></a><span class=n>chart</span><span class=o>.</span><span class=n>y_axis</span><span class=o>.</span><span class=n>title</span> <span class=o>=</span> <span class=s1>&#39;销量&#39;</span>
</span><span id=__span-28-27><a id=__codelineno-28-27 name=__codelineno-28-27 href=#__codelineno-28-27></a><span class=c1># 设置图表横轴的标题</span>
</span><span id=__span-28-28><a id=__codelineno-28-28 name=__codelineno-28-28 href=#__codelineno-28-28></a><span class=n>chart</span><span class=o>.</span><span class=n>x_axis</span><span class=o>.</span><span class=n>title</span> <span class=o>=</span> <span class=s1>&#39;商品类别&#39;</span>
</span><span id=__span-28-29><a id=__codelineno-28-29 name=__codelineno-28-29 href=#__codelineno-28-29></a><span class=c1># 设置数据的范围</span>
</span><span id=__span-28-30><a id=__codelineno-28-30 name=__codelineno-28-30 href=#__codelineno-28-30></a><span class=n>data</span> <span class=o>=</span> <span class=n>Reference</span><span class=p>(</span><span class=n>sheet</span><span class=p>,</span> <span class=n>min_col</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>min_row</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>max_row</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>max_col</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span><span id=__span-28-31><a id=__codelineno-28-31 name=__codelineno-28-31 href=#__codelineno-28-31></a><span class=c1># 设置分类的范围</span>
</span><span id=__span-28-32><a id=__codelineno-28-32 name=__codelineno-28-32 href=#__codelineno-28-32></a><span class=n>cats</span> <span class=o>=</span> <span class=n>Reference</span><span class=p>(</span><span class=n>sheet</span><span class=p>,</span> <span class=n>min_col</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>min_row</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>max_row</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span><span id=__span-28-33><a id=__codelineno-28-33 name=__codelineno-28-33 href=#__codelineno-28-33></a><span class=c1># 给图表添加数据</span>
</span><span id=__span-28-34><a id=__codelineno-28-34 name=__codelineno-28-34 href=#__codelineno-28-34></a><span class=n>chart</span><span class=o>.</span><span class=n>add_data</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>titles_from_data</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-28-35><a id=__codelineno-28-35 name=__codelineno-28-35 href=#__codelineno-28-35></a><span class=c1># 给图表设置分类</span>
</span><span id=__span-28-36><a id=__codelineno-28-36 name=__codelineno-28-36 href=#__codelineno-28-36></a><span class=n>chart</span><span class=o>.</span><span class=n>set_categories</span><span class=p>(</span><span class=n>cats</span><span class=p>)</span>
</span><span id=__span-28-37><a id=__codelineno-28-37 name=__codelineno-28-37 href=#__codelineno-28-37></a><span class=n>chart</span><span class=o>.</span><span class=n>shape</span> <span class=o>=</span> <span class=mi>4</span>
</span><span id=__span-28-38><a id=__codelineno-28-38 name=__codelineno-28-38 href=#__codelineno-28-38></a><span class=c1># 将图表添加到表单指定的单元格中</span>
</span><span id=__span-28-39><a id=__codelineno-28-39 name=__codelineno-28-39 href=#__codelineno-28-39></a><span class=n>sheet</span><span class=o>.</span><span class=n>add_chart</span><span class=p>(</span><span class=n>chart</span><span class=p>,</span> <span class=s1>&#39;A10&#39;</span><span class=p>)</span>
</span><span id=__span-28-40><a id=__codelineno-28-40 name=__codelineno-28-40 href=#__codelineno-28-40></a>
</span><span id=__span-28-41><a id=__codelineno-28-41 name=__codelineno-28-41 href=#__codelineno-28-41></a><span class=n>wb</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s1>&#39;demo.xlsx&#39;</span><span class=p>)</span>
</span></code></pre></div> <p>运行上面的代码，打开生成的Excel文件，效果如下图所示。</p> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210819235009.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img src=https://github.com/jackfrued/mypic/raw/master/20210819235009.png alt=image-20210819235009026 width=75%></a></p> <h2 id=27pythonpdf>第27课：用Python操作PDF文件<a class=headerlink href=#27pythonpdf title="Permanent link">&para;</a></h2> <p>PDF是Portable Document Format的缩写，这类文件通常使用<code>.pdf</code>作为其扩展名。在日常开发工作中，最容易遇到的就是从PDF中读取文本内容以及用已有的内容生成PDF文档这两个任务。</p> <h3 id=pdf>从PDF中提取文本<a class=headerlink href=#pdf title="Permanent link">&para;</a></h3> <p>在Python中，可以使用名为<code>PyPDF2</code>的三方库来读取PDF文件，可以使用下面的命令来安装它。</p> <div class="language-Bash highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>pip<span class=w> </span>install<span class=w> </span>PyPDF2
</span></code></pre></div> <p><code>PyPDF2</code>没有办法从PDF文档中提取图像、图表或其他媒体，但它可以提取文本，并将其返回为Python字符串。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=kn>import</span><span class=w> </span><span class=nn>PyPDF2</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=n>reader</span> <span class=o>=</span> <span class=n>PyPDF2</span><span class=o>.</span><span class=n>PdfReader</span><span class=p>(</span><span class=s1>&#39;test.pdf&#39;</span><span class=p>)</span>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=k>for</span> <span class=n>page</span> <span class=ow>in</span> <span class=n>reader</span><span class=o>.</span><span class=n>pages</span><span class=p>:</span>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a>    <span class=nb>print</span><span class=p>(</span><span class=n>page</span><span class=o>.</span><span class=n>extract_text</span><span class=p>())</span>
</span></code></pre></div> <blockquote> <p><strong>提示</strong>：上面代码中使用的PDF文件“test.pdf”以及下面的代码中需要用到的PDF文件，也可以通过下面的百度云盘地址进行获取。链接:<a href=https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g>https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g</a> 提取码:e7b4。</p> </blockquote> <p>当然，<code>PyPDF2</code>并不是什么样的PDF文档都能提取出文字来，这个问题就我所知并没有什么特别好的解决方法，尤其是在提取中文的时候。网上也有很多讲解从PDF中提取文字的文章，推荐大家自行阅读<a href=https://cloud.tencent.com/developer/article/1395339>《三大神器助力Python提取pdf文档信息》</a>一文进行了解。</p> <p>要从PDF文件中提取文本也可以直接使用三方的命令行工具，具体的做法如下所示。</p> <div class="language-Bash highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a>pip<span class=w> </span>install<span class=w> </span>pdfminer.six
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>pdf2text.py<span class=w> </span>test.pdf
</span></code></pre></div> <h3 id=_6>旋转和叠加页面<a class=headerlink href=#_6 title="Permanent link">&para;</a></h3> <p>上面的代码中通过创建<code>PdfFileReader</code>对象的方式来读取PDF文档，该对象的<code>getPage</code>方法可以获得PDF文档的指定页并得到一个<code>PageObject</code>对象，通过<code>PageObject</code>对象的<code>rotateClockwise</code>和<code>rotateCounterClockwise</code>方法可以实现页面的顺时针和逆时针方向旋转，通过<code>PageObject</code>对象的<code>addBlankPage</code>方法可以添加一个新的空白页，代码如下所示。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=n>reader</span> <span class=o>=</span> <span class=n>PyPDF2</span><span class=o>.</span><span class=n>PdfReader</span><span class=p>(</span><span class=s1>&#39;XGBoost.pdf&#39;</span><span class=p>)</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=n>writer</span> <span class=o>=</span> <span class=n>PyPDF2</span><span class=o>.</span><span class=n>PdfWriter</span><span class=p>()</span>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=k>for</span> <span class=n>no</span><span class=p>,</span> <span class=n>page</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>reader</span><span class=o>.</span><span class=n>pages</span><span class=p>):</span>
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a>    <span class=k>if</span> <span class=n>no</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a>        <span class=n>new_page</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>rotate</span><span class=p>(</span><span class=o>-</span><span class=mi>90</span><span class=p>)</span>
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-32-8><a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>        <span class=n>new_page</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>rotate</span><span class=p>(</span><span class=mi>90</span><span class=p>)</span>
</span><span id=__span-32-9><a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a>    <span class=n>writer</span><span class=o>.</span><span class=n>add_page</span><span class=p>(</span><span class=n>new_page</span><span class=p>)</span>
</span><span id=__span-32-10><a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a>
</span><span id=__span-32-11><a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;temp.pdf&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file_obj</span><span class=p>:</span>
</span><span id=__span-32-12><a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a>    <span class=n>writer</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>file_obj</span><span class=p>)</span>
</span></code></pre></div> <h3 id=pdf_1>加密PDF文件<a class=headerlink href=#pdf_1 title="Permanent link">&para;</a></h3> <p>使用<code>PyPDF2</code>中的<code>PdfFileWrite</code>对象可以为PDF文档加密，如果需要给一系列的PDF文档设置统一的访问口令，使用Python程序来处理就会非常的方便。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-33-1><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=kn>import</span><span class=w> </span><span class=nn>PyPDF2</span>
</span><span id=__span-33-2><a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>
</span><span id=__span-33-3><a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=n>reader</span> <span class=o>=</span> <span class=n>PyPDF2</span><span class=o>.</span><span class=n>PdfReader</span><span class=p>(</span><span class=s1>&#39;XGBoost.pdf&#39;</span><span class=p>)</span>
</span><span id=__span-33-4><a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=n>writer</span> <span class=o>=</span> <span class=n>PyPDF2</span><span class=o>.</span><span class=n>PdfWriter</span><span class=p>()</span>
</span><span id=__span-33-5><a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a>
</span><span id=__span-33-6><a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a><span class=k>for</span> <span class=n>page</span> <span class=ow>in</span> <span class=n>reader</span><span class=o>.</span><span class=n>pages</span><span class=p>:</span>
</span><span id=__span-33-7><a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>    <span class=n>writer</span><span class=o>.</span><span class=n>add_page</span><span class=p>(</span><span class=n>page</span><span class=p>)</span>
</span><span id=__span-33-8><a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a>
</span><span id=__span-33-9><a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a><span class=n>writer</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=s1>&#39;foobared&#39;</span><span class=p>)</span>
</span><span id=__span-33-10><a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a>
</span><span id=__span-33-11><a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;temp.pdf&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file_obj</span><span class=p>:</span>
</span><span id=__span-33-12><a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a>    <span class=n>writer</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>file_obj</span><span class=p>)</span>
</span></code></pre></div> <h3 id=_7>批量添加水印<a class=headerlink href=#_7 title="Permanent link">&para;</a></h3> <p>上面提到的<code>PageObject</code>对象还有一个名为<code>mergePage</code>的方法，可以两个PDF页面进行叠加，通过这个操作，我们很容易实现给PDF文件添加水印的功能。例如要给上面的“XGBoost.pdf”文件添加一个水印，我们可以先准备好一个提供水印页面的PDF文件，然后将包含水印的<code>PageObject</code>读取出来，然后再循环遍历“XGBoost.pdf”文件的每个页，获取到<code>PageObject</code>对象，然后通过<code>mergePage</code>方法实现水印页和原始页的合并，代码如下所示。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-34-1><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=n>reader1</span> <span class=o>=</span> <span class=n>PyPDF2</span><span class=o>.</span><span class=n>PdfReader</span><span class=p>(</span><span class=s1>&#39;XGBoost.pdf&#39;</span><span class=p>)</span>
</span><span id=__span-34-2><a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=n>reader2</span> <span class=o>=</span> <span class=n>PyPDF2</span><span class=o>.</span><span class=n>PdfReader</span><span class=p>(</span><span class=s1>&#39;watermark.pdf&#39;</span><span class=p>)</span>
</span><span id=__span-34-3><a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=n>writer</span> <span class=o>=</span> <span class=n>PyPDF2</span><span class=o>.</span><span class=n>PdfWriter</span><span class=p>()</span>
</span><span id=__span-34-4><a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=n>watermark_page</span> <span class=o>=</span> <span class=n>reader2</span><span class=o>.</span><span class=n>pages</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-34-5><a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>
</span><span id=__span-34-6><a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a><span class=k>for</span> <span class=n>page</span> <span class=ow>in</span> <span class=n>reader1</span><span class=o>.</span><span class=n>pages</span><span class=p>:</span>
</span><span id=__span-34-7><a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>    <span class=n>page</span><span class=o>.</span><span class=n>merge_page</span><span class=p>(</span><span class=n>watermark_page</span><span class=p>)</span>
</span><span id=__span-34-8><a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a>    <span class=n>writer</span><span class=o>.</span><span class=n>add_page</span><span class=p>(</span><span class=n>page</span><span class=p>)</span>
</span><span id=__span-34-9><a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>
</span><span id=__span-34-10><a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;temp.pdf&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file_obj</span><span class=p>:</span>
</span><span id=__span-34-11><a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a>    <span class=n>writer</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>file_obj</span><span class=p>)</span>
</span></code></pre></div> <p>如果愿意，还可以让奇数页和偶数页使用不同的水印，大家可以自己思考下应该怎么做。</p> <h3 id=pdf_2>创建PDF文件<a class=headerlink href=#pdf_2 title="Permanent link">&para;</a></h3> <p>创建PDF文档需要三方库<code>reportlab</code>的支持，安装的方法如下所示。</p> <div class="language-Bash highlight"><pre><span></span><code><span id=__span-35-1><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>pip<span class=w> </span>install<span class=w> </span>reportlab
</span></code></pre></div> <p>下面通过一个例子为大家展示<code>reportlab</code>的用法。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-36-1><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=kn>from</span><span class=w> </span><span class=nn>reportlab.lib.pagesizes</span><span class=w> </span><span class=kn>import</span> <span class=n>A4</span>
</span><span id=__span-36-2><a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=kn>from</span><span class=w> </span><span class=nn>reportlab.pdfbase</span><span class=w> </span><span class=kn>import</span> <span class=n>pdfmetrics</span>
</span><span id=__span-36-3><a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=kn>from</span><span class=w> </span><span class=nn>reportlab.pdfbase.ttfonts</span><span class=w> </span><span class=kn>import</span> <span class=n>TTFont</span>
</span><span id=__span-36-4><a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=kn>from</span><span class=w> </span><span class=nn>reportlab.pdfgen</span><span class=w> </span><span class=kn>import</span> <span class=n>canvas</span>
</span><span id=__span-36-5><a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a>
</span><span id=__span-36-6><a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a><span class=n>pdf_canvas</span> <span class=o>=</span> <span class=n>canvas</span><span class=o>.</span><span class=n>Canvas</span><span class=p>(</span><span class=s1>&#39;resources/demo.pdf&#39;</span><span class=p>,</span> <span class=n>pagesize</span><span class=o>=</span><span class=n>A4</span><span class=p>)</span>
</span><span id=__span-36-7><a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a><span class=n>width</span><span class=p>,</span> <span class=n>height</span> <span class=o>=</span> <span class=n>A4</span>
</span><span id=__span-36-8><a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a>
</span><span id=__span-36-9><a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a><span class=c1># 绘图</span>
</span><span id=__span-36-10><a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a><span class=n>image</span> <span class=o>=</span> <span class=n>canvas</span><span class=o>.</span><span class=n>ImageReader</span><span class=p>(</span><span class=s1>&#39;resources/guido.jpg&#39;</span><span class=p>)</span>
</span><span id=__span-36-11><a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a><span class=n>pdf_canvas</span><span class=o>.</span><span class=n>drawImage</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=n>height</span> <span class=o>-</span> <span class=mi>395</span><span class=p>,</span> <span class=mi>250</span><span class=p>,</span> <span class=mi>375</span><span class=p>)</span>
</span><span id=__span-36-12><a id=__codelineno-36-12 name=__codelineno-36-12 href=#__codelineno-36-12></a>
</span><span id=__span-36-13><a id=__codelineno-36-13 name=__codelineno-36-13 href=#__codelineno-36-13></a><span class=c1># 显示当前页</span>
</span><span id=__span-36-14><a id=__codelineno-36-14 name=__codelineno-36-14 href=#__codelineno-36-14></a><span class=n>pdf_canvas</span><span class=o>.</span><span class=n>showPage</span><span class=p>()</span>
</span><span id=__span-36-15><a id=__codelineno-36-15 name=__codelineno-36-15 href=#__codelineno-36-15></a>
</span><span id=__span-36-16><a id=__codelineno-36-16 name=__codelineno-36-16 href=#__codelineno-36-16></a><span class=c1># 注册字体文件</span>
</span><span id=__span-36-17><a id=__codelineno-36-17 name=__codelineno-36-17 href=#__codelineno-36-17></a><span class=n>pdfmetrics</span><span class=o>.</span><span class=n>registerFont</span><span class=p>(</span><span class=n>TTFont</span><span class=p>(</span><span class=s1>&#39;Font1&#39;</span><span class=p>,</span> <span class=s1>&#39;resources/fonts/Vera.ttf&#39;</span><span class=p>))</span>
</span><span id=__span-36-18><a id=__codelineno-36-18 name=__codelineno-36-18 href=#__codelineno-36-18></a><span class=n>pdfmetrics</span><span class=o>.</span><span class=n>registerFont</span><span class=p>(</span><span class=n>TTFont</span><span class=p>(</span><span class=s1>&#39;Font2&#39;</span><span class=p>,</span> <span class=s1>&#39;resources/fonts/青呱石头体.ttf&#39;</span><span class=p>))</span>
</span><span id=__span-36-19><a id=__codelineno-36-19 name=__codelineno-36-19 href=#__codelineno-36-19></a>
</span><span id=__span-36-20><a id=__codelineno-36-20 name=__codelineno-36-20 href=#__codelineno-36-20></a><span class=c1># 写字</span>
</span><span id=__span-36-21><a id=__codelineno-36-21 name=__codelineno-36-21 href=#__codelineno-36-21></a><span class=n>pdf_canvas</span><span class=o>.</span><span class=n>setFont</span><span class=p>(</span><span class=s1>&#39;Font2&#39;</span><span class=p>,</span> <span class=mi>40</span><span class=p>)</span>
</span><span id=__span-36-22><a id=__codelineno-36-22 name=__codelineno-36-22 href=#__codelineno-36-22></a><span class=n>pdf_canvas</span><span class=o>.</span><span class=n>setFillColorRGB</span><span class=p>(</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-36-23><a id=__codelineno-36-23 name=__codelineno-36-23 href=#__codelineno-36-23></a><span class=n>pdf_canvas</span><span class=o>.</span><span class=n>drawString</span><span class=p>(</span><span class=n>width</span> <span class=o>//</span> <span class=mi>2</span> <span class=o>-</span> <span class=mi>120</span><span class=p>,</span> <span class=n>height</span> <span class=o>//</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;你好，世界！&#39;</span><span class=p>)</span>
</span><span id=__span-36-24><a id=__codelineno-36-24 name=__codelineno-36-24 href=#__codelineno-36-24></a><span class=n>pdf_canvas</span><span class=o>.</span><span class=n>setFont</span><span class=p>(</span><span class=s1>&#39;Font1&#39;</span><span class=p>,</span> <span class=mi>40</span><span class=p>)</span>
</span><span id=__span-36-25><a id=__codelineno-36-25 name=__codelineno-36-25 href=#__codelineno-36-25></a><span class=n>pdf_canvas</span><span class=o>.</span><span class=n>setFillColorRGB</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>)</span>
</span><span id=__span-36-26><a id=__codelineno-36-26 name=__codelineno-36-26 href=#__codelineno-36-26></a><span class=n>pdf_canvas</span><span class=o>.</span><span class=n>rotate</span><span class=p>(</span><span class=mi>18</span><span class=p>)</span>
</span><span id=__span-36-27><a id=__codelineno-36-27 name=__codelineno-36-27 href=#__codelineno-36-27></a><span class=n>pdf_canvas</span><span class=o>.</span><span class=n>drawString</span><span class=p>(</span><span class=mi>250</span><span class=p>,</span> <span class=mi>250</span><span class=p>,</span> <span class=s1>&#39;hello, world!&#39;</span><span class=p>)</span>
</span><span id=__span-36-28><a id=__codelineno-36-28 name=__codelineno-36-28 href=#__codelineno-36-28></a>
</span><span id=__span-36-29><a id=__codelineno-36-29 name=__codelineno-36-29 href=#__codelineno-36-29></a><span class=c1># 保存</span>
</span><span id=__span-36-30><a id=__codelineno-36-30 name=__codelineno-36-30 href=#__codelineno-36-30></a><span class=n>pdf_canvas</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
</span></code></pre></div> <p>上面的代码如果不太理解也没有关系，等真正需要用Python创建PDF文档的时候，再好好研读一下<code>reportlab</code>的<a href=https://www.reportlab.com/docs/reportlab-userguide.pdf>官方文档</a>就可以了。</p> <blockquote> <p><strong>提示</strong>：上面代码中用到的图片和字体，也可以通过下面的百度云盘链接获取。链接:<a href=https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g>https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g</a> 提取码:e7b4。</p> </blockquote> <h3 id=_8>简单的总结<a class=headerlink href=#_8 title="Permanent link">&para;</a></h3> <p>在学习完上面的内容之后，相信大家已经知道像合并多个PDF文件这样的工作应该如何用Python代码来处理了，赶紧自己动手试一试吧。</p> <h2 id=28python>第28课：用Python处理图像<a class=headerlink href=#28python title="Permanent link">&para;</a></h2> <h3 id=_9>入门知识<a class=headerlink href=#_9 title="Permanent link">&para;</a></h3> <ol> <li>颜色。如果你有使用颜料画画的经历，那么一定知道混合红、黄、蓝三种颜料可以得到其他的颜色，事实上这三种颜色就是美术中的三原色，它们是不能再分解的基本颜色。在计算机中，我们可以将红、绿、蓝三种色光以不同的比例叠加来组合成其他的颜色，因此这三种颜色就是色光三原色。在计算机系统中，我们通常会将一个颜色表示为一个RGB值或RGBA值（其中的A表示Alpha通道，它决定了透过这个图像的像素，也就是透明度）。</li> </ol> <table> <thead> <tr> <th style="text-align: center;">名称</th> <th style="text-align: center;">RGB值</th> <th style="text-align: center;">名称</th> <th style="text-align: center;">RGB值</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;">White（白）</td> <td style="text-align: center;">(255, 255, 255)</td> <td style="text-align: center;">Red（红）</td> <td style="text-align: center;">(255, 0, 0)</td> </tr> <tr> <td style="text-align: center;">Green（绿）</td> <td style="text-align: center;">(0, 255, 0)</td> <td style="text-align: center;">Blue（蓝）</td> <td style="text-align: center;">(0, 0, 255)</td> </tr> <tr> <td style="text-align: center;">Gray（灰）</td> <td style="text-align: center;">(128, 128, 128)</td> <td style="text-align: center;">Yellow（黄）</td> <td style="text-align: center;">(255, 255, 0)</td> </tr> <tr> <td style="text-align: center;">Black（黑）</td> <td style="text-align: center;">(0, 0, 0)</td> <td style="text-align: center;">Purple（紫）</td> <td style="text-align: center;">(128, 0, 128)</td> </tr> </tbody> </table> <ol start=2> <li>像素。对于一个由数字序列表示的图像来说，最小的单位就是图像上单一颜色的小方格，这些小方块都有一个明确的位置和被分配的色彩数值，而这些一小方格的颜色和位置决定了该图像最终呈现出来的样子，它们是不可分割的单位，我们通常称之为像素（pixel）。每一个图像都包含了一定量的像素，这些像素决定图像在屏幕上所呈现的大小，大家如果爱好拍照或者自拍，对像素这个词就不会陌生。</li> </ol> <h3 id=pillow>用Pillow处理图像<a class=headerlink href=#pillow title="Permanent link">&para;</a></h3> <p>Pillow是由从著名的Python图像处理库PIL发展出来的一个分支，通过Pillow可以实现图像压缩和图像处理等各种操作。可以使用下面的命令来安装Pillow。</p> <div class="language-Shell highlight"><pre><span></span><code><span id=__span-37-1><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a>pip<span class=w> </span>install<span class=w> </span>pillow
</span></code></pre></div> <p>Pillow中最为重要的是<code>Image</code>类，可以通过<code>Image</code>模块的<code>open</code>函数来读取图像并获得<code>Image</code>类型的对象。</p> <ol> <li>读取和显示图像</li> </ol> <div class="language-Python highlight"><pre><span></span><code><span id=__span-38-1><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=kn>from</span><span class=w> </span><span class=nn>PIL</span><span class=w> </span><span class=kn>import</span> <span class=n>Image</span>
</span><span id=__span-38-2><a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a>
</span><span id=__span-38-3><a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=c1># 读取图像获得Image对象</span>
</span><span id=__span-38-4><a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a><span class=n>image</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;guido.jpg&#39;</span><span class=p>)</span>
</span><span id=__span-38-5><a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a><span class=c1># 通过Image对象的format属性获得图像的格式</span>
</span><span id=__span-38-6><a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a><span class=nb>print</span><span class=p>(</span><span class=n>image</span><span class=o>.</span><span class=n>format</span><span class=p>)</span> <span class=c1># JPEG</span>
</span><span id=__span-38-7><a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a><span class=c1># 通过Image对象的size属性获得图像的尺寸</span>
</span><span id=__span-38-8><a id=__codelineno-38-8 name=__codelineno-38-8 href=#__codelineno-38-8></a><span class=nb>print</span><span class=p>(</span><span class=n>image</span><span class=o>.</span><span class=n>size</span><span class=p>)</span>   <span class=c1># (500, 750)</span>
</span><span id=__span-38-9><a id=__codelineno-38-9 name=__codelineno-38-9 href=#__codelineno-38-9></a><span class=c1># 通过Image对象的mode属性获取图像的模式</span>
</span><span id=__span-38-10><a id=__codelineno-38-10 name=__codelineno-38-10 href=#__codelineno-38-10></a><span class=nb>print</span><span class=p>(</span><span class=n>image</span><span class=o>.</span><span class=n>mode</span><span class=p>)</span>   <span class=c1># RGB</span>
</span><span id=__span-38-11><a id=__codelineno-38-11 name=__codelineno-38-11 href=#__codelineno-38-11></a><span class=c1># 通过Image对象的show方法显示图像</span>
</span><span id=__span-38-12><a id=__codelineno-38-12 name=__codelineno-38-12 href=#__codelineno-38-12></a><span class=n>image</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210803202628.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img src=https://github.com/jackfrued/mypic/raw/master/20210803202628.png width=80%></a></p> <ol start=2> <li>剪裁图像</li> </ol> <div class="language-Python highlight"><pre><span></span><code><span id=__span-39-1><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=c1># 通过Image对象的crop方法指定剪裁区域剪裁图像</span>
</span><span id=__span-39-2><a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a><span class=n>image</span><span class=o>.</span><span class=n>crop</span><span class=p>((</span><span class=mi>80</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>310</span><span class=p>,</span> <span class=mi>360</span><span class=p>))</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210803202701.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img src=https://github.com/jackfrued/mypic/raw/master/20210803202701.png width=80%></a></p> <ol start=3> <li>生成缩略图</li> </ol> <div class="language-Python highlight"><pre><span></span><code><span id=__span-40-1><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=c1># 通过Image对象的thumbnail方法生成指定尺寸的缩略图</span>
</span><span id=__span-40-2><a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=n>image</span><span class=o>.</span><span class=n>thumbnail</span><span class=p>((</span><span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>))</span>
</span><span id=__span-40-3><a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=n>image</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210803202722.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img src=https://github.com/jackfrued/mypic/raw/master/20210803202722.png width=100%></a></p> <ol start=4> <li>缩放和黏贴图像</li> </ol> <div class="language-Python highlight"><pre><span></span><code><span id=__span-41-1><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=c1># 读取骆昊的照片获得Image对象</span>
</span><span id=__span-41-2><a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=n>luohao_image</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;luohao.png&#39;</span><span class=p>)</span>
</span><span id=__span-41-3><a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=c1># 读取吉多的照片获得Image对象</span>
</span><span id=__span-41-4><a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a><span class=n>guido_image</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;guido.jpg&#39;</span><span class=p>)</span>
</span><span id=__span-41-5><a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=c1># 从吉多的照片上剪裁出吉多的头</span>
</span><span id=__span-41-6><a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a><span class=n>guido_head</span> <span class=o>=</span> <span class=n>guido_image</span><span class=o>.</span><span class=n>crop</span><span class=p>((</span><span class=mi>80</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>310</span><span class=p>,</span> <span class=mi>360</span><span class=p>))</span>
</span><span id=__span-41-7><a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a><span class=n>width</span><span class=p>,</span> <span class=n>height</span> <span class=o>=</span> <span class=n>guido_head</span><span class=o>.</span><span class=n>size</span>
</span><span id=__span-41-8><a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a><span class=c1># 使用Image对象的resize方法修改图像的尺寸</span>
</span><span id=__span-41-9><a id=__codelineno-41-9 name=__codelineno-41-9 href=#__codelineno-41-9></a><span class=c1># 使用Image对象的paste方法将吉多的头粘贴到骆昊的照片上</span>
</span><span id=__span-41-10><a id=__codelineno-41-10 name=__codelineno-41-10 href=#__codelineno-41-10></a><span class=n>luohao_image</span><span class=o>.</span><span class=n>paste</span><span class=p>(</span><span class=n>guido_head</span><span class=o>.</span><span class=n>resize</span><span class=p>((</span><span class=nb>int</span><span class=p>(</span><span class=n>width</span> <span class=o>/</span> <span class=mf>1.5</span><span class=p>),</span> <span class=nb>int</span><span class=p>(</span><span class=n>height</span> <span class=o>/</span> <span class=mf>1.5</span><span class=p>))),</span> <span class=p>(</span><span class=mi>172</span><span class=p>,</span> <span class=mi>40</span><span class=p>))</span>
</span><span id=__span-41-11><a id=__codelineno-41-11 name=__codelineno-41-11 href=#__codelineno-41-11></a><span class=n>luohao_image</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210803202749.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img src=https://github.com/jackfrued/mypic/raw/master/20210803202749.png width=80%></a></p> <ol start=5> <li>旋转和翻转</li> </ol> <div class="language-Python highlight"><pre><span></span><code><span id=__span-42-1><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=n>image</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;guido.jpg&#39;</span><span class=p>)</span>
</span><span id=__span-42-2><a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a><span class=c1># 使用Image对象的rotate方法实现图像的旋转</span>
</span><span id=__span-42-3><a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=n>image</span><span class=o>.</span><span class=n>rotate</span><span class=p>(</span><span class=mi>45</span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-42-4><a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a><span class=c1># 使用Image对象的transpose方法实现图像翻转</span>
</span><span id=__span-42-5><a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a><span class=c1># Image.FLIP_LEFT_RIGHT - 水平翻转</span>
</span><span id=__span-42-6><a id=__codelineno-42-6 name=__codelineno-42-6 href=#__codelineno-42-6></a><span class=c1># Image.FLIP_TOP_BOTTOM - 垂直翻转</span>
</span><span id=__span-42-7><a id=__codelineno-42-7 name=__codelineno-42-7 href=#__codelineno-42-7></a><span class=n>image</span><span class=o>.</span><span class=n>transpose</span><span class=p>(</span><span class=n>Image</span><span class=o>.</span><span class=n>FLIP_TOP_BOTTOM</span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210803202829.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img src=https://github.com/jackfrued/mypic/raw/master/20210803202829.png width=80%></a></p> <ol start=6> <li>操作像素</li> </ol> <div class="language-Python highlight"><pre><span></span><code><span id=__span-43-1><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>80</span><span class=p>,</span> <span class=mi>310</span><span class=p>):</span>
</span><span id=__span-43-2><a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a>    <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>360</span><span class=p>):</span>
</span><span id=__span-43-3><a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a>        <span class=c1># 通过Image对象的putpixel方法修改图像指定像素点</span>
</span><span id=__span-43-4><a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a>        <span class=n>image</span><span class=o>.</span><span class=n>putpixel</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=p>(</span><span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>))</span>
</span><span id=__span-43-5><a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a><span class=n>image</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210803202932.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img src=https://github.com/jackfrued/mypic/raw/master/20210803202932.png width=80%></a></p> <ol start=7> <li>滤镜效果</li> </ol> <div class="language-Python highlight"><pre><span></span><code><span id=__span-44-1><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=kn>from</span><span class=w> </span><span class=nn>PIL</span><span class=w> </span><span class=kn>import</span> <span class=n>ImageFilter</span>
</span><span id=__span-44-2><a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a>
</span><span id=__span-44-3><a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a><span class=c1># 使用Image对象的filter方法对图像进行滤镜处理</span>
</span><span id=__span-44-4><a id=__codelineno-44-4 name=__codelineno-44-4 href=#__codelineno-44-4></a><span class=c1># ImageFilter模块包含了诸多预设的滤镜也可以自定义滤镜</span>
</span><span id=__span-44-5><a id=__codelineno-44-5 name=__codelineno-44-5 href=#__codelineno-44-5></a><span class=n>image</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>ImageFilter</span><span class=o>.</span><span class=n>CONTOUR</span><span class=p>)</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210803202953.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img src=https://github.com/jackfrued/mypic/raw/master/20210803202953.png width=80%></a></p> <h3 id=pillow_1>使用Pillow绘图<a class=headerlink href=#pillow_1 title="Permanent link">&para;</a></h3> <p>Pillow中有一个名为<code>ImageDraw</code>的模块，该模块的<code>Draw</code>函数会返回一个<code>ImageDraw</code>对象，通过<code>ImageDraw</code>对象的<code>arc</code>、<code>line</code>、<code>rectangle</code>、<code>ellipse</code>、<code>polygon</code>等方法，可以在图像上绘制出圆弧、线条、矩形、椭圆、多边形等形状，也可以通过该对象的<code>text</code>方法在图像上添加文字。</p> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210803203016.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img src=https://github.com/jackfrued/mypic/raw/master/20210803203016.png width=80%></a></p> <p>要绘制如上图所示的图像，完整的代码如下所示。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-45-1><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=kn>import</span><span class=w> </span><span class=nn>random</span>
</span><span id=__span-45-2><a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a>
</span><span id=__span-45-3><a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a><span class=kn>from</span><span class=w> </span><span class=nn>PIL</span><span class=w> </span><span class=kn>import</span> <span class=n>Image</span><span class=p>,</span> <span class=n>ImageDraw</span><span class=p>,</span> <span class=n>ImageFont</span>
</span><span id=__span-45-4><a id=__codelineno-45-4 name=__codelineno-45-4 href=#__codelineno-45-4></a>
</span><span id=__span-45-5><a id=__codelineno-45-5 name=__codelineno-45-5 href=#__codelineno-45-5></a>
</span><span id=__span-45-6><a id=__codelineno-45-6 name=__codelineno-45-6 href=#__codelineno-45-6></a><span class=k>def</span><span class=w> </span><span class=nf>random_color</span><span class=p>():</span>
</span><span id=__span-45-7><a id=__codelineno-45-7 name=__codelineno-45-7 href=#__codelineno-45-7></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;生成随机颜色&quot;&quot;&quot;</span>
</span><span id=__span-45-8><a id=__codelineno-45-8 name=__codelineno-45-8 href=#__codelineno-45-8></a>    <span class=n>red</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>)</span>
</span><span id=__span-45-9><a id=__codelineno-45-9 name=__codelineno-45-9 href=#__codelineno-45-9></a>    <span class=n>green</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>)</span>
</span><span id=__span-45-10><a id=__codelineno-45-10 name=__codelineno-45-10 href=#__codelineno-45-10></a>    <span class=n>blue</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>)</span>
</span><span id=__span-45-11><a id=__codelineno-45-11 name=__codelineno-45-11 href=#__codelineno-45-11></a>    <span class=k>return</span> <span class=n>red</span><span class=p>,</span> <span class=n>green</span><span class=p>,</span> <span class=n>blue</span>
</span><span id=__span-45-12><a id=__codelineno-45-12 name=__codelineno-45-12 href=#__codelineno-45-12></a>
</span><span id=__span-45-13><a id=__codelineno-45-13 name=__codelineno-45-13 href=#__codelineno-45-13></a>
</span><span id=__span-45-14><a id=__codelineno-45-14 name=__codelineno-45-14 href=#__codelineno-45-14></a><span class=n>width</span><span class=p>,</span> <span class=n>height</span> <span class=o>=</span> <span class=mi>800</span><span class=p>,</span> <span class=mi>600</span>
</span><span id=__span-45-15><a id=__codelineno-45-15 name=__codelineno-45-15 href=#__codelineno-45-15></a><span class=c1># 创建一个800*600的图像，背景色为白色</span>
</span><span id=__span-45-16><a id=__codelineno-45-16 name=__codelineno-45-16 href=#__codelineno-45-16></a><span class=n>image</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=s1>&#39;RGB&#39;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>),</span> <span class=n>color</span><span class=o>=</span><span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>))</span>
</span><span id=__span-45-17><a id=__codelineno-45-17 name=__codelineno-45-17 href=#__codelineno-45-17></a><span class=c1># 创建一个ImageDraw对象</span>
</span><span id=__span-45-18><a id=__codelineno-45-18 name=__codelineno-45-18 href=#__codelineno-45-18></a><span class=n>drawer</span> <span class=o>=</span> <span class=n>ImageDraw</span><span class=o>.</span><span class=n>Draw</span><span class=p>(</span><span class=n>image</span><span class=p>)</span>
</span><span id=__span-45-19><a id=__codelineno-45-19 name=__codelineno-45-19 href=#__codelineno-45-19></a><span class=c1># 通过指定字体和大小获得ImageFont对象</span>
</span><span id=__span-45-20><a id=__codelineno-45-20 name=__codelineno-45-20 href=#__codelineno-45-20></a><span class=n>font</span> <span class=o>=</span> <span class=n>ImageFont</span><span class=o>.</span><span class=n>truetype</span><span class=p>(</span><span class=s1>&#39;Kongxin.ttf&#39;</span><span class=p>,</span> <span class=mi>32</span><span class=p>)</span>
</span><span id=__span-45-21><a id=__codelineno-45-21 name=__codelineno-45-21 href=#__codelineno-45-21></a><span class=c1># 通过ImageDraw对象的text方法绘制文字</span>
</span><span id=__span-45-22><a id=__codelineno-45-22 name=__codelineno-45-22 href=#__codelineno-45-22></a><span class=n>drawer</span><span class=o>.</span><span class=n>text</span><span class=p>((</span><span class=mi>300</span><span class=p>,</span> <span class=mi>50</span><span class=p>),</span> <span class=s1>&#39;Hello, world!&#39;</span><span class=p>,</span> <span class=n>fill</span><span class=o>=</span><span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>font</span><span class=o>=</span><span class=n>font</span><span class=p>)</span>
</span><span id=__span-45-23><a id=__codelineno-45-23 name=__codelineno-45-23 href=#__codelineno-45-23></a><span class=c1># 通过ImageDraw对象的line方法绘制两条对角直线</span>
</span><span id=__span-45-24><a id=__codelineno-45-24 name=__codelineno-45-24 href=#__codelineno-45-24></a><span class=n>drawer</span><span class=o>.</span><span class=n>line</span><span class=p>((</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>),</span> <span class=n>fill</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>),</span> <span class=n>width</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-45-25><a id=__codelineno-45-25 name=__codelineno-45-25 href=#__codelineno-45-25></a><span class=n>drawer</span><span class=o>.</span><span class=n>line</span><span class=p>((</span><span class=n>width</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>height</span><span class=p>),</span> <span class=n>fill</span><span class=o>=</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>),</span> <span class=n>width</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-45-26><a id=__codelineno-45-26 name=__codelineno-45-26 href=#__codelineno-45-26></a><span class=n>xy</span> <span class=o>=</span> <span class=n>width</span> <span class=o>//</span> <span class=mi>2</span> <span class=o>-</span> <span class=mi>60</span><span class=p>,</span> <span class=n>height</span> <span class=o>//</span> <span class=mi>2</span> <span class=o>-</span> <span class=mi>60</span><span class=p>,</span> <span class=n>width</span> <span class=o>//</span> <span class=mi>2</span> <span class=o>+</span> <span class=mi>60</span><span class=p>,</span> <span class=n>height</span> <span class=o>//</span> <span class=mi>2</span> <span class=o>+</span> <span class=mi>60</span>
</span><span id=__span-45-27><a id=__codelineno-45-27 name=__codelineno-45-27 href=#__codelineno-45-27></a><span class=c1># 通过ImageDraw对象的rectangle方法绘制矩形</span>
</span><span id=__span-45-28><a id=__codelineno-45-28 name=__codelineno-45-28 href=#__codelineno-45-28></a><span class=n>drawer</span><span class=o>.</span><span class=n>rectangle</span><span class=p>(</span><span class=n>xy</span><span class=p>,</span> <span class=n>outline</span><span class=o>=</span><span class=p>(</span><span class=mi>255</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=n>width</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-45-29><a id=__codelineno-45-29 name=__codelineno-45-29 href=#__codelineno-45-29></a><span class=c1># 通过ImageDraw对象的ellipse方法绘制椭圆</span>
</span><span id=__span-45-30><a id=__codelineno-45-30 name=__codelineno-45-30 href=#__codelineno-45-30></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span><span id=__span-45-31><a id=__codelineno-45-31 name=__codelineno-45-31 href=#__codelineno-45-31></a>    <span class=n>left</span><span class=p>,</span> <span class=n>top</span><span class=p>,</span> <span class=n>right</span><span class=p>,</span> <span class=n>bottom</span> <span class=o>=</span> <span class=mi>150</span> <span class=o>+</span> <span class=n>i</span> <span class=o>*</span> <span class=mi>120</span><span class=p>,</span> <span class=mi>220</span><span class=p>,</span> <span class=mi>310</span> <span class=o>+</span> <span class=n>i</span> <span class=o>*</span> <span class=mi>120</span><span class=p>,</span> <span class=mi>380</span>
</span><span id=__span-45-32><a id=__codelineno-45-32 name=__codelineno-45-32 href=#__codelineno-45-32></a>    <span class=n>drawer</span><span class=o>.</span><span class=n>ellipse</span><span class=p>((</span><span class=n>left</span><span class=p>,</span> <span class=n>top</span><span class=p>,</span> <span class=n>right</span><span class=p>,</span> <span class=n>bottom</span><span class=p>),</span> <span class=n>outline</span><span class=o>=</span><span class=n>random_color</span><span class=p>(),</span> <span class=n>width</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
</span><span id=__span-45-33><a id=__codelineno-45-33 name=__codelineno-45-33 href=#__codelineno-45-33></a><span class=c1># 显示图像</span>
</span><span id=__span-45-34><a id=__codelineno-45-34 name=__codelineno-45-34 href=#__codelineno-45-34></a><span class=n>image</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-45-35><a id=__codelineno-45-35 name=__codelineno-45-35 href=#__codelineno-45-35></a><span class=c1># 保存图像</span>
</span><span id=__span-45-36><a id=__codelineno-45-36 name=__codelineno-45-36 href=#__codelineno-45-36></a><span class=n>image</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s1>&#39;result.png&#39;</span><span class=p>)</span>
</span></code></pre></div> <blockquote> <p><strong>注意</strong>：上面代码中使用的字体文件需要根据自己准备，可以选择自己喜欢的字体文件并放置在代码目录下。</p> </blockquote> <h3 id=_10>简单的总结<a class=headerlink href=#_10 title="Permanent link">&para;</a></h3> <p>使用Python语言做开发，除了可以用Pillow来处理图像外，还可以使用更为强大的OpenCV库来完成图形图像的处理，OpenCV（<strong>Open</strong> Source <strong>C</strong>omputer <strong>V</strong>ision Library）是一个跨平台的计算机视觉库，可以用来开发实时图像处理、计算机视觉和模式识别程序。在我们的日常工作中，有很多繁琐乏味的任务其实都可以通过Python程序来处理，编程的目的就是让计算机帮助我们解决问题，减少重复乏味的劳动。通过本章节的学习，相信大家已经感受到了使用Python程序绘图P图的乐趣，其实Python能做的事情还远不止这些，继续你的学习吧。</p> <h2 id=29python>第29课：用Python发送邮件和短信<a class=headerlink href=#29python title="Permanent link">&para;</a></h2> <p>在前面的课程中，我们已经教会大家如何用Python程序自动的生成Excel、Word、PDF文档，接下来我们还可以更进一步，就是通过邮件将生成好的文档发送给指定的收件人，然后用短信告知对方我们发出了邮件。这些事情利用Python程序也可以轻松愉快的解决。</p> <h3 id=_11>发送电子邮件<a class=headerlink href=#_11 title="Permanent link">&para;</a></h3> <p>在即时通信软件如此发达的今天，电子邮件仍然是互联网上使用最为广泛的应用之一，公司向应聘者发出录用通知、网站向用户发送一个激活账号的链接、银行向客户推广它们的理财产品等几乎都是通过电子邮件来完成的，而这些任务应该都是由程序自动完成的。</p> <p>我们可以用HTTP（超文本传输协议）来访问网站资源，HTTP是一个应用级协议，它建立在TCP（传输控制协议）之上，TCP为很多应用级协议提供了可靠的数据传输服务。如果要发送电子邮件，需要使用SMTP（简单邮件传输协议），它也是建立在TCP之上的应用级协议，规定了邮件的发送者如何跟邮件服务器进行通信的细节。Python通过名为<code>smtplib</code>的模块将这些操作简化成了<code>SMTP_SSL</code>对象，通过该对象的<code>login</code>和<code>send_mail</code>方法，就能够完成发送邮件的操作。</p> <p>我们先尝试一下发送一封极为简单的邮件，该邮件不包含附件、图片以及其他超文本内容。发送邮件首先需要接入邮件服务器，我们可以自己架设邮件服务器，这件事情对新手并不友好，但是我们可以选择使用第三方提供的邮件服务。例如，我在<www.126.com>已经注册了账号，登录成功之后，就可以在设置中开启SMTP服务，这样就相当于获得了邮件服务器，具体的操作如下所示。</p> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210820190307.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img src=https://github.com/jackfrued/mypic/raw/master/20210820190307.png alt=image-20210820190306861 width=95%></a></p> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210820190816.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt=image-20210820190816557 src=https://github.com/jackfrued/mypic/raw/master/20210820190816.png></a></p> <p>用手机扫码上面的二维码可以通过发送短信的方式来获取授权码，短信发送成功后，点击“我已发送”就可以获得授权码。授权码需要妥善保管，因为一旦泄露就会被其他人冒用你的身份来发送邮件。接下来，我们就可以编写发送邮件的代码了，如下所示。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-46-1><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=kn>import</span><span class=w> </span><span class=nn>smtplib</span>
</span><span id=__span-46-2><a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a><span class=kn>from</span><span class=w> </span><span class=nn>email.header</span><span class=w> </span><span class=kn>import</span> <span class=n>Header</span>
</span><span id=__span-46-3><a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a><span class=kn>from</span><span class=w> </span><span class=nn>email.mime.multipart</span><span class=w> </span><span class=kn>import</span> <span class=n>MIMEMultipart</span>
</span><span id=__span-46-4><a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a><span class=kn>from</span><span class=w> </span><span class=nn>email.mime.text</span><span class=w> </span><span class=kn>import</span> <span class=n>MIMEText</span>
</span><span id=__span-46-5><a id=__codelineno-46-5 name=__codelineno-46-5 href=#__codelineno-46-5></a>
</span><span id=__span-46-6><a id=__codelineno-46-6 name=__codelineno-46-6 href=#__codelineno-46-6></a><span class=c1># 创建邮件主体对象</span>
</span><span id=__span-46-7><a id=__codelineno-46-7 name=__codelineno-46-7 href=#__codelineno-46-7></a><span class=n>email</span> <span class=o>=</span> <span class=n>MIMEMultipart</span><span class=p>()</span>
</span><span id=__span-46-8><a id=__codelineno-46-8 name=__codelineno-46-8 href=#__codelineno-46-8></a><span class=c1># 设置发件人、收件人和主题</span>
</span><span id=__span-46-9><a id=__codelineno-46-9 name=__codelineno-46-9 href=#__codelineno-46-9></a><span class=n>email</span><span class=p>[</span><span class=s1>&#39;From&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;xxxxxxxxx@126.com&#39;</span>
</span><span id=__span-46-10><a id=__codelineno-46-10 name=__codelineno-46-10 href=#__codelineno-46-10></a><span class=n>email</span><span class=p>[</span><span class=s1>&#39;To&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;yyyyyy@qq.com;zzzzzz@1000phone.com&#39;</span>
</span><span id=__span-46-11><a id=__codelineno-46-11 name=__codelineno-46-11 href=#__codelineno-46-11></a><span class=n>email</span><span class=p>[</span><span class=s1>&#39;Subject&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>Header</span><span class=p>(</span><span class=s1>&#39;上半年工作情况汇报&#39;</span><span class=p>,</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span><span id=__span-46-12><a id=__codelineno-46-12 name=__codelineno-46-12 href=#__codelineno-46-12></a><span class=c1># 添加邮件正文内容</span>
</span><span id=__span-46-13><a id=__codelineno-46-13 name=__codelineno-46-13 href=#__codelineno-46-13></a><span class=n>content</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;据德国媒体报道，当地时间9日，德国火车司机工会成员进行了投票，</span>
</span><span id=__span-46-14><a id=__codelineno-46-14 name=__codelineno-46-14 href=#__codelineno-46-14></a><span class=s2>定于当地时间10日起进行全国性罢工，货运交通方面的罢工已于当地时间10日19时开始。</span>
</span><span id=__span-46-15><a id=__codelineno-46-15 name=__codelineno-46-15 href=#__codelineno-46-15></a><span class=s2>此后，从11日凌晨2时到13日凌晨2时，德国全国范围内的客运和铁路基础设施将进行48小时的罢工。&quot;&quot;&quot;</span>
</span><span id=__span-46-16><a id=__codelineno-46-16 name=__codelineno-46-16 href=#__codelineno-46-16></a><span class=n>email</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>MIMEText</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=s1>&#39;plain&#39;</span><span class=p>,</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span><span id=__span-46-17><a id=__codelineno-46-17 name=__codelineno-46-17 href=#__codelineno-46-17></a>
</span><span id=__span-46-18><a id=__codelineno-46-18 name=__codelineno-46-18 href=#__codelineno-46-18></a><span class=c1># 创建SMTP_SSL对象（连接邮件服务器）</span>
</span><span id=__span-46-19><a id=__codelineno-46-19 name=__codelineno-46-19 href=#__codelineno-46-19></a><span class=n>smtp_obj</span> <span class=o>=</span> <span class=n>smtplib</span><span class=o>.</span><span class=n>SMTP_SSL</span><span class=p>(</span><span class=s1>&#39;smtp.126.com&#39;</span><span class=p>,</span> <span class=mi>465</span><span class=p>)</span>
</span><span id=__span-46-20><a id=__codelineno-46-20 name=__codelineno-46-20 href=#__codelineno-46-20></a><span class=c1># 通过用户名和授权码进行登录</span>
</span><span id=__span-46-21><a id=__codelineno-46-21 name=__codelineno-46-21 href=#__codelineno-46-21></a><span class=n>smtp_obj</span><span class=o>.</span><span class=n>login</span><span class=p>(</span><span class=s1>&#39;xxxxxxxxx@126.com&#39;</span><span class=p>,</span> <span class=s1>&#39;邮件服务器的授权码&#39;</span><span class=p>)</span>
</span><span id=__span-46-22><a id=__codelineno-46-22 name=__codelineno-46-22 href=#__codelineno-46-22></a><span class=c1># 发送邮件（发件人、收件人、邮件内容（字符串））</span>
</span><span id=__span-46-23><a id=__codelineno-46-23 name=__codelineno-46-23 href=#__codelineno-46-23></a><span class=n>smtp_obj</span><span class=o>.</span><span class=n>sendmail</span><span class=p>(</span>
</span><span id=__span-46-24><a id=__codelineno-46-24 name=__codelineno-46-24 href=#__codelineno-46-24></a>    <span class=s1>&#39;xxxxxxxxx@126.com&#39;</span><span class=p>,</span>
</span><span id=__span-46-25><a id=__codelineno-46-25 name=__codelineno-46-25 href=#__codelineno-46-25></a>    <span class=p>[</span><span class=s1>&#39;yyyyyy@qq.com&#39;</span><span class=p>,</span> <span class=s1>&#39;zzzzzz@1000phone.com&#39;</span><span class=p>],</span>
</span><span id=__span-46-26><a id=__codelineno-46-26 name=__codelineno-46-26 href=#__codelineno-46-26></a>    <span class=n>email</span><span class=o>.</span><span class=n>as_string</span><span class=p>()</span>
</span><span id=__span-46-27><a id=__codelineno-46-27 name=__codelineno-46-27 href=#__codelineno-46-27></a><span class=p>)</span>
</span></code></pre></div> <p>如果要发送带有附件的邮件，只需要将附件的内容处理成BASE64编码，那么它就和普通的文本内容几乎没有什么区别。BASE64是一种基于64个可打印字符来表示二进制数据的表示方法，常用于某些需要表示、传输、存储二进制数据的场合，电子邮件就是其中之一。对这种编码方式不理解的同学，推荐阅读<a href=http://www.ruanyifeng.com/blog/2008/06/base64.html>《Base64笔记》</a>一文。在之前的内容中，我们也提到过，Python标准库的<code>base64</code>模块提供了对BASE64编解码的支持。</p> <p>下面的代码演示了如何发送带附件的邮件。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-47-1><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=kn>import</span><span class=w> </span><span class=nn>smtplib</span>
</span><span id=__span-47-2><a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a><span class=kn>from</span><span class=w> </span><span class=nn>email.header</span><span class=w> </span><span class=kn>import</span> <span class=n>Header</span>
</span><span id=__span-47-3><a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a><span class=kn>from</span><span class=w> </span><span class=nn>email.mime.multipart</span><span class=w> </span><span class=kn>import</span> <span class=n>MIMEMultipart</span>
</span><span id=__span-47-4><a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a><span class=kn>from</span><span class=w> </span><span class=nn>email.mime.text</span><span class=w> </span><span class=kn>import</span> <span class=n>MIMEText</span>
</span><span id=__span-47-5><a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a><span class=kn>from</span><span class=w> </span><span class=nn>urllib.parse</span><span class=w> </span><span class=kn>import</span> <span class=n>quote</span>
</span><span id=__span-47-6><a id=__codelineno-47-6 name=__codelineno-47-6 href=#__codelineno-47-6></a>
</span><span id=__span-47-7><a id=__codelineno-47-7 name=__codelineno-47-7 href=#__codelineno-47-7></a><span class=c1># 创建邮件主体对象</span>
</span><span id=__span-47-8><a id=__codelineno-47-8 name=__codelineno-47-8 href=#__codelineno-47-8></a><span class=n>email</span> <span class=o>=</span> <span class=n>MIMEMultipart</span><span class=p>()</span>
</span><span id=__span-47-9><a id=__codelineno-47-9 name=__codelineno-47-9 href=#__codelineno-47-9></a><span class=c1># 设置发件人、收件人和主题</span>
</span><span id=__span-47-10><a id=__codelineno-47-10 name=__codelineno-47-10 href=#__codelineno-47-10></a><span class=n>email</span><span class=p>[</span><span class=s1>&#39;From&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;xxxxxxxxx@126.com&#39;</span>
</span><span id=__span-47-11><a id=__codelineno-47-11 name=__codelineno-47-11 href=#__codelineno-47-11></a><span class=n>email</span><span class=p>[</span><span class=s1>&#39;To&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;zzzzzzzz@1000phone.com&#39;</span>
</span><span id=__span-47-12><a id=__codelineno-47-12 name=__codelineno-47-12 href=#__codelineno-47-12></a><span class=n>email</span><span class=p>[</span><span class=s1>&#39;Subject&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>Header</span><span class=p>(</span><span class=s1>&#39;请查收离职证明文件&#39;</span><span class=p>,</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span><span id=__span-47-13><a id=__codelineno-47-13 name=__codelineno-47-13 href=#__codelineno-47-13></a><span class=c1># 添加邮件正文内容（带HTML标签排版的内容）</span>
</span><span id=__span-47-14><a id=__codelineno-47-14 name=__codelineno-47-14 href=#__codelineno-47-14></a><span class=n>content</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;&lt;p&gt;亲爱的前同事：&lt;/p&gt;</span>
</span><span id=__span-47-15><a id=__codelineno-47-15 name=__codelineno-47-15 href=#__codelineno-47-15></a><span class=s2>&lt;p&gt;你需要的离职证明在附件中，请查收！&lt;/p&gt;</span>
</span><span id=__span-47-16><a id=__codelineno-47-16 name=__codelineno-47-16 href=#__codelineno-47-16></a><span class=s2>&lt;br&gt;</span>
</span><span id=__span-47-17><a id=__codelineno-47-17 name=__codelineno-47-17 href=#__codelineno-47-17></a><span class=s2>&lt;p&gt;祝，好！&lt;/p&gt;</span>
</span><span id=__span-47-18><a id=__codelineno-47-18 name=__codelineno-47-18 href=#__codelineno-47-18></a><span class=s2>&lt;hr&gt;</span>
</span><span id=__span-47-19><a id=__codelineno-47-19 name=__codelineno-47-19 href=#__codelineno-47-19></a><span class=s2>&lt;p&gt;孙美丽 即日&lt;/p&gt;&quot;&quot;&quot;</span>
</span><span id=__span-47-20><a id=__codelineno-47-20 name=__codelineno-47-20 href=#__codelineno-47-20></a><span class=n>email</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>MIMEText</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=s1>&#39;html&#39;</span><span class=p>,</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span><span id=__span-47-21><a id=__codelineno-47-21 name=__codelineno-47-21 href=#__codelineno-47-21></a><span class=c1># 读取作为附件的文件</span>
</span><span id=__span-47-22><a id=__codelineno-47-22 name=__codelineno-47-22 href=#__codelineno-47-22></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;resources/王大锤离职证明.docx&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-47-23><a id=__codelineno-47-23 name=__codelineno-47-23 href=#__codelineno-47-23></a>    <span class=n>attachment</span> <span class=o>=</span> <span class=n>MIMEText</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>read</span><span class=p>(),</span> <span class=s1>&#39;base64&#39;</span><span class=p>,</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span><span id=__span-47-24><a id=__codelineno-47-24 name=__codelineno-47-24 href=#__codelineno-47-24></a>    <span class=c1># 指定内容类型</span>
</span><span id=__span-47-25><a id=__codelineno-47-25 name=__codelineno-47-25 href=#__codelineno-47-25></a>    <span class=n>attachment</span><span class=p>[</span><span class=s1>&#39;content-type&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;application/octet-stream&#39;</span>
</span><span id=__span-47-26><a id=__codelineno-47-26 name=__codelineno-47-26 href=#__codelineno-47-26></a>    <span class=c1># 将中文文件名处理成百分号编码</span>
</span><span id=__span-47-27><a id=__codelineno-47-27 name=__codelineno-47-27 href=#__codelineno-47-27></a>    <span class=n>filename</span> <span class=o>=</span> <span class=n>quote</span><span class=p>(</span><span class=s1>&#39;王大锤离职证明.docx&#39;</span><span class=p>)</span>
</span><span id=__span-47-28><a id=__codelineno-47-28 name=__codelineno-47-28 href=#__codelineno-47-28></a>    <span class=c1># 指定如何处置内容</span>
</span><span id=__span-47-29><a id=__codelineno-47-29 name=__codelineno-47-29 href=#__codelineno-47-29></a>    <span class=n>attachment</span><span class=p>[</span><span class=s1>&#39;content-disposition&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;attachment; filename=&quot;</span><span class=si>{</span><span class=n>filename</span><span class=si>}</span><span class=s1>&quot;&#39;</span>
</span><span id=__span-47-30><a id=__codelineno-47-30 name=__codelineno-47-30 href=#__codelineno-47-30></a>
</span><span id=__span-47-31><a id=__codelineno-47-31 name=__codelineno-47-31 href=#__codelineno-47-31></a><span class=c1># 创建SMTP_SSL对象（连接邮件服务器）</span>
</span><span id=__span-47-32><a id=__codelineno-47-32 name=__codelineno-47-32 href=#__codelineno-47-32></a><span class=n>smtp_obj</span> <span class=o>=</span> <span class=n>smtplib</span><span class=o>.</span><span class=n>SMTP_SSL</span><span class=p>(</span><span class=s1>&#39;smtp.126.com&#39;</span><span class=p>,</span> <span class=mi>465</span><span class=p>)</span>
</span><span id=__span-47-33><a id=__codelineno-47-33 name=__codelineno-47-33 href=#__codelineno-47-33></a><span class=c1># 通过用户名和授权码进行登录</span>
</span><span id=__span-47-34><a id=__codelineno-47-34 name=__codelineno-47-34 href=#__codelineno-47-34></a><span class=n>smtp_obj</span><span class=o>.</span><span class=n>login</span><span class=p>(</span><span class=s1>&#39;xxxxxxxxx@126.com&#39;</span><span class=p>,</span> <span class=s1>&#39;邮件服务器的授权码&#39;</span><span class=p>)</span>
</span><span id=__span-47-35><a id=__codelineno-47-35 name=__codelineno-47-35 href=#__codelineno-47-35></a><span class=c1># 发送邮件（发件人、收件人、邮件内容（字符串））</span>
</span><span id=__span-47-36><a id=__codelineno-47-36 name=__codelineno-47-36 href=#__codelineno-47-36></a><span class=n>smtp_obj</span><span class=o>.</span><span class=n>sendmail</span><span class=p>(</span>
</span><span id=__span-47-37><a id=__codelineno-47-37 name=__codelineno-47-37 href=#__codelineno-47-37></a>    <span class=s1>&#39;xxxxxxxxx@126.com&#39;</span><span class=p>,</span>
</span><span id=__span-47-38><a id=__codelineno-47-38 name=__codelineno-47-38 href=#__codelineno-47-38></a>    <span class=s1>&#39;zzzzzzzz@1000phone.com&#39;</span><span class=p>,</span>
</span><span id=__span-47-39><a id=__codelineno-47-39 name=__codelineno-47-39 href=#__codelineno-47-39></a>    <span class=n>email</span><span class=o>.</span><span class=n>as_string</span><span class=p>()</span>
</span><span id=__span-47-40><a id=__codelineno-47-40 name=__codelineno-47-40 href=#__codelineno-47-40></a><span class=p>)</span>
</span></code></pre></div> <p>为了方便大家用Python实现邮件发送，我将上面的代码封装成了函数，使用的时候大家只需要调整邮件服务器域名、端口、用户名和授权码就可以了。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-48-1><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=kn>import</span><span class=w> </span><span class=nn>smtplib</span>
</span><span id=__span-48-2><a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a><span class=kn>from</span><span class=w> </span><span class=nn>email.header</span><span class=w> </span><span class=kn>import</span> <span class=n>Header</span>
</span><span id=__span-48-3><a id=__codelineno-48-3 name=__codelineno-48-3 href=#__codelineno-48-3></a><span class=kn>from</span><span class=w> </span><span class=nn>email.mime.multipart</span><span class=w> </span><span class=kn>import</span> <span class=n>MIMEMultipart</span>
</span><span id=__span-48-4><a id=__codelineno-48-4 name=__codelineno-48-4 href=#__codelineno-48-4></a><span class=kn>from</span><span class=w> </span><span class=nn>email.mime.text</span><span class=w> </span><span class=kn>import</span> <span class=n>MIMEText</span>
</span><span id=__span-48-5><a id=__codelineno-48-5 name=__codelineno-48-5 href=#__codelineno-48-5></a><span class=kn>from</span><span class=w> </span><span class=nn>urllib.parse</span><span class=w> </span><span class=kn>import</span> <span class=n>quote</span>
</span><span id=__span-48-6><a id=__codelineno-48-6 name=__codelineno-48-6 href=#__codelineno-48-6></a>
</span><span id=__span-48-7><a id=__codelineno-48-7 name=__codelineno-48-7 href=#__codelineno-48-7></a><span class=c1># 邮件服务器域名（自行修改）</span>
</span><span id=__span-48-8><a id=__codelineno-48-8 name=__codelineno-48-8 href=#__codelineno-48-8></a><span class=n>EMAIL_HOST</span> <span class=o>=</span> <span class=s1>&#39;smtp.126.com&#39;</span>
</span><span id=__span-48-9><a id=__codelineno-48-9 name=__codelineno-48-9 href=#__codelineno-48-9></a><span class=c1># 邮件服务端口（通常是465）</span>
</span><span id=__span-48-10><a id=__codelineno-48-10 name=__codelineno-48-10 href=#__codelineno-48-10></a><span class=n>EMAIL_PORT</span> <span class=o>=</span> <span class=mi>465</span>
</span><span id=__span-48-11><a id=__codelineno-48-11 name=__codelineno-48-11 href=#__codelineno-48-11></a><span class=c1># 登录邮件服务器的账号（自行修改）</span>
</span><span id=__span-48-12><a id=__codelineno-48-12 name=__codelineno-48-12 href=#__codelineno-48-12></a><span class=n>EMAIL_USER</span> <span class=o>=</span> <span class=s1>&#39;xxxxxxxxx@126.com&#39;</span>
</span><span id=__span-48-13><a id=__codelineno-48-13 name=__codelineno-48-13 href=#__codelineno-48-13></a><span class=c1># 开通SMTP服务的授权码（自行修改）</span>
</span><span id=__span-48-14><a id=__codelineno-48-14 name=__codelineno-48-14 href=#__codelineno-48-14></a><span class=n>EMAIL_AUTH</span> <span class=o>=</span> <span class=s1>&#39;邮件服务器的授权码&#39;</span>
</span><span id=__span-48-15><a id=__codelineno-48-15 name=__codelineno-48-15 href=#__codelineno-48-15></a>
</span><span id=__span-48-16><a id=__codelineno-48-16 name=__codelineno-48-16 href=#__codelineno-48-16></a>
</span><span id=__span-48-17><a id=__codelineno-48-17 name=__codelineno-48-17 href=#__codelineno-48-17></a><span class=k>def</span><span class=w> </span><span class=nf>send_email</span><span class=p>(</span><span class=o>*</span><span class=p>,</span> <span class=n>from_user</span><span class=p>,</span> <span class=n>to_users</span><span class=p>,</span> <span class=n>subject</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>filenames</span><span class=o>=</span><span class=p>[]):</span>
</span><span id=__span-48-18><a id=__codelineno-48-18 name=__codelineno-48-18 href=#__codelineno-48-18></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;发送邮件</span>
</span><span id=__span-48-19><a id=__codelineno-48-19 name=__codelineno-48-19 href=#__codelineno-48-19></a>
</span><span id=__span-48-20><a id=__codelineno-48-20 name=__codelineno-48-20 href=#__codelineno-48-20></a><span class=sd>    :param from_user: 发件人</span>
</span><span id=__span-48-21><a id=__codelineno-48-21 name=__codelineno-48-21 href=#__codelineno-48-21></a><span class=sd>    :param to_users: 收件人，多个收件人用英文分号进行分隔</span>
</span><span id=__span-48-22><a id=__codelineno-48-22 name=__codelineno-48-22 href=#__codelineno-48-22></a><span class=sd>    :param subject: 邮件的主题</span>
</span><span id=__span-48-23><a id=__codelineno-48-23 name=__codelineno-48-23 href=#__codelineno-48-23></a><span class=sd>    :param content: 邮件正文内容</span>
</span><span id=__span-48-24><a id=__codelineno-48-24 name=__codelineno-48-24 href=#__codelineno-48-24></a><span class=sd>    :param filenames: 附件要发送的文件路径</span>
</span><span id=__span-48-25><a id=__codelineno-48-25 name=__codelineno-48-25 href=#__codelineno-48-25></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-48-26><a id=__codelineno-48-26 name=__codelineno-48-26 href=#__codelineno-48-26></a>    <span class=n>email</span> <span class=o>=</span> <span class=n>MIMEMultipart</span><span class=p>()</span>
</span><span id=__span-48-27><a id=__codelineno-48-27 name=__codelineno-48-27 href=#__codelineno-48-27></a>    <span class=n>email</span><span class=p>[</span><span class=s1>&#39;From&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>from_user</span>
</span><span id=__span-48-28><a id=__codelineno-48-28 name=__codelineno-48-28 href=#__codelineno-48-28></a>    <span class=n>email</span><span class=p>[</span><span class=s1>&#39;To&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>to_users</span>
</span><span id=__span-48-29><a id=__codelineno-48-29 name=__codelineno-48-29 href=#__codelineno-48-29></a>    <span class=n>email</span><span class=p>[</span><span class=s1>&#39;Subject&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>subject</span>
</span><span id=__span-48-30><a id=__codelineno-48-30 name=__codelineno-48-30 href=#__codelineno-48-30></a>
</span><span id=__span-48-31><a id=__codelineno-48-31 name=__codelineno-48-31 href=#__codelineno-48-31></a>    <span class=n>message</span> <span class=o>=</span> <span class=n>MIMEText</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=s1>&#39;plain&#39;</span><span class=p>,</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span><span id=__span-48-32><a id=__codelineno-48-32 name=__codelineno-48-32 href=#__codelineno-48-32></a>    <span class=n>email</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span><span id=__span-48-33><a id=__codelineno-48-33 name=__codelineno-48-33 href=#__codelineno-48-33></a>    <span class=k>for</span> <span class=n>filename</span> <span class=ow>in</span> <span class=n>filenames</span><span class=p>:</span>
</span><span id=__span-48-34><a id=__codelineno-48-34 name=__codelineno-48-34 href=#__codelineno-48-34></a>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span><span id=__span-48-35><a id=__codelineno-48-35 name=__codelineno-48-35 href=#__codelineno-48-35></a>            <span class=n>pos</span> <span class=o>=</span> <span class=n>filename</span><span class=o>.</span><span class=n>rfind</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span><span id=__span-48-36><a id=__codelineno-48-36 name=__codelineno-48-36 href=#__codelineno-48-36></a>            <span class=n>display_filename</span> <span class=o>=</span> <span class=n>filename</span><span class=p>[</span><span class=n>pos</span> <span class=o>+</span> <span class=mi>1</span><span class=p>:]</span> <span class=k>if</span> <span class=n>pos</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=k>else</span> <span class=n>filename</span>
</span><span id=__span-48-37><a id=__codelineno-48-37 name=__codelineno-48-37 href=#__codelineno-48-37></a>            <span class=n>display_filename</span> <span class=o>=</span> <span class=n>quote</span><span class=p>(</span><span class=n>display_filename</span><span class=p>)</span>
</span><span id=__span-48-38><a id=__codelineno-48-38 name=__codelineno-48-38 href=#__codelineno-48-38></a>            <span class=n>attachment</span> <span class=o>=</span> <span class=n>MIMEText</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>read</span><span class=p>(),</span> <span class=s1>&#39;base64&#39;</span><span class=p>,</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span><span id=__span-48-39><a id=__codelineno-48-39 name=__codelineno-48-39 href=#__codelineno-48-39></a>            <span class=n>attachment</span><span class=p>[</span><span class=s1>&#39;content-type&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;application/octet-stream&#39;</span>
</span><span id=__span-48-40><a id=__codelineno-48-40 name=__codelineno-48-40 href=#__codelineno-48-40></a>            <span class=n>attachment</span><span class=p>[</span><span class=s1>&#39;content-disposition&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;attachment; filename=&quot;</span><span class=si>{</span><span class=n>display_filename</span><span class=si>}</span><span class=s1>&quot;&#39;</span>
</span><span id=__span-48-41><a id=__codelineno-48-41 name=__codelineno-48-41 href=#__codelineno-48-41></a>            <span class=n>email</span><span class=o>.</span><span class=n>attach</span><span class=p>(</span><span class=n>attachment</span><span class=p>)</span>
</span><span id=__span-48-42><a id=__codelineno-48-42 name=__codelineno-48-42 href=#__codelineno-48-42></a>
</span><span id=__span-48-43><a id=__codelineno-48-43 name=__codelineno-48-43 href=#__codelineno-48-43></a>    <span class=n>smtp</span> <span class=o>=</span> <span class=n>smtplib</span><span class=o>.</span><span class=n>SMTP_SSL</span><span class=p>(</span><span class=n>EMAIL_HOST</span><span class=p>,</span> <span class=n>EMAIL_PORT</span><span class=p>)</span>
</span><span id=__span-48-44><a id=__codelineno-48-44 name=__codelineno-48-44 href=#__codelineno-48-44></a>    <span class=n>smtp</span><span class=o>.</span><span class=n>login</span><span class=p>(</span><span class=n>EMAIL_USER</span><span class=p>,</span> <span class=n>EMAIL_AUTH</span><span class=p>)</span>
</span><span id=__span-48-45><a id=__codelineno-48-45 name=__codelineno-48-45 href=#__codelineno-48-45></a>    <span class=n>smtp</span><span class=o>.</span><span class=n>sendmail</span><span class=p>(</span><span class=n>from_user</span><span class=p>,</span> <span class=n>to_users</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;;&#39;</span><span class=p>),</span> <span class=n>email</span><span class=o>.</span><span class=n>as_string</span><span class=p>())</span>
</span></code></pre></div> <h3 id=_12>发送短信<a class=headerlink href=#_12 title="Permanent link">&para;</a></h3> <p>发送短信也是项目中常见的功能，网站的注册码、验证码、营销信息基本上都是通过短信来发送给用户的。发送短信需要三方平台的支持，下面我们以<a href=https://luosimao.com/ >螺丝帽平台</a>为例，为大家介绍如何用Python程序发送短信。注册账号和购买短信服务的细节我们不在这里进行赘述，大家可以咨询平台的客服。</p> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210820194421.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt=image-20210820194420911 src=https://github.com/jackfrued/mypic/raw/master/20210820194421.png></a></p> <p>接下来，我们可以通过<code>requests</code>库向平台提供的短信网关发起一个HTTP请求，通过将接收短信的手机号和短信内容作为参数，就可以发送短信，代码如下所示。</p> <div class="language-Python highlight"><pre><span></span><code><span id=__span-49-1><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=kn>import</span><span class=w> </span><span class=nn>random</span>
</span><span id=__span-49-2><a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a>
</span><span id=__span-49-3><a id=__codelineno-49-3 name=__codelineno-49-3 href=#__codelineno-49-3></a><span class=kn>import</span><span class=w> </span><span class=nn>requests</span>
</span><span id=__span-49-4><a id=__codelineno-49-4 name=__codelineno-49-4 href=#__codelineno-49-4></a>
</span><span id=__span-49-5><a id=__codelineno-49-5 name=__codelineno-49-5 href=#__codelineno-49-5></a>
</span><span id=__span-49-6><a id=__codelineno-49-6 name=__codelineno-49-6 href=#__codelineno-49-6></a><span class=k>def</span><span class=w> </span><span class=nf>send_message_by_luosimao</span><span class=p>(</span><span class=n>tel</span><span class=p>,</span> <span class=n>message</span><span class=p>):</span>
</span><span id=__span-49-7><a id=__codelineno-49-7 name=__codelineno-49-7 href=#__codelineno-49-7></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;发送短信（调用螺丝帽短信网关）&quot;&quot;&quot;</span>
</span><span id=__span-49-8><a id=__codelineno-49-8 name=__codelineno-49-8 href=#__codelineno-49-8></a>    <span class=n>resp</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span>
</span><span id=__span-49-9><a id=__codelineno-49-9 name=__codelineno-49-9 href=#__codelineno-49-9></a>        <span class=n>url</span><span class=o>=</span><span class=s1>&#39;http://sms-api.luosimao.com/v1/send.json&#39;</span><span class=p>,</span>
</span><span id=__span-49-10><a id=__codelineno-49-10 name=__codelineno-49-10 href=#__codelineno-49-10></a>        <span class=n>auth</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;api&#39;</span><span class=p>,</span> <span class=s1>&#39;key-注册成功后平台分配的KEY&#39;</span><span class=p>),</span>
</span><span id=__span-49-11><a id=__codelineno-49-11 name=__codelineno-49-11 href=#__codelineno-49-11></a>        <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span><span id=__span-49-12><a id=__codelineno-49-12 name=__codelineno-49-12 href=#__codelineno-49-12></a>            <span class=s1>&#39;mobile&#39;</span><span class=p>:</span> <span class=n>tel</span><span class=p>,</span>
</span><span id=__span-49-13><a id=__codelineno-49-13 name=__codelineno-49-13 href=#__codelineno-49-13></a>            <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=n>message</span>
</span><span id=__span-49-14><a id=__codelineno-49-14 name=__codelineno-49-14 href=#__codelineno-49-14></a>        <span class=p>},</span>
</span><span id=__span-49-15><a id=__codelineno-49-15 name=__codelineno-49-15 href=#__codelineno-49-15></a>        <span class=n>timeout</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
</span><span id=__span-49-16><a id=__codelineno-49-16 name=__codelineno-49-16 href=#__codelineno-49-16></a>        <span class=n>verify</span><span class=o>=</span><span class=kc>False</span>
</span><span id=__span-49-17><a id=__codelineno-49-17 name=__codelineno-49-17 href=#__codelineno-49-17></a>    <span class=p>)</span>
</span><span id=__span-49-18><a id=__codelineno-49-18 name=__codelineno-49-18 href=#__codelineno-49-18></a>    <span class=k>return</span> <span class=n>resp</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span><span id=__span-49-19><a id=__codelineno-49-19 name=__codelineno-49-19 href=#__codelineno-49-19></a>
</span><span id=__span-49-20><a id=__codelineno-49-20 name=__codelineno-49-20 href=#__codelineno-49-20></a>
</span><span id=__span-49-21><a id=__codelineno-49-21 name=__codelineno-49-21 href=#__codelineno-49-21></a><span class=k>def</span><span class=w> </span><span class=nf>gen_mobile_code</span><span class=p>(</span><span class=n>length</span><span class=o>=</span><span class=mi>6</span><span class=p>):</span>
</span><span id=__span-49-22><a id=__codelineno-49-22 name=__codelineno-49-22 href=#__codelineno-49-22></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;生成指定长度的手机验证码&quot;&quot;&quot;</span>
</span><span id=__span-49-23><a id=__codelineno-49-23 name=__codelineno-49-23 href=#__codelineno-49-23></a>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>choices</span><span class=p>(</span><span class=s1>&#39;0123456789&#39;</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=n>length</span><span class=p>))</span>
</span><span id=__span-49-24><a id=__codelineno-49-24 name=__codelineno-49-24 href=#__codelineno-49-24></a>
</span><span id=__span-49-25><a id=__codelineno-49-25 name=__codelineno-49-25 href=#__codelineno-49-25></a>
</span><span id=__span-49-26><a id=__codelineno-49-26 name=__codelineno-49-26 href=#__codelineno-49-26></a><span class=k>def</span><span class=w> </span><span class=nf>main</span><span class=p>():</span>
</span><span id=__span-49-27><a id=__codelineno-49-27 name=__codelineno-49-27 href=#__codelineno-49-27></a>    <span class=n>code</span> <span class=o>=</span> <span class=n>gen_mobile_code</span><span class=p>()</span>
</span><span id=__span-49-28><a id=__codelineno-49-28 name=__codelineno-49-28 href=#__codelineno-49-28></a>    <span class=n>message</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;您的短信验证码是</span><span class=si>{</span><span class=n>code</span><span class=si>}</span><span class=s1>，打死也不能告诉别人哟！【Python小课】&#39;</span>
</span><span id=__span-49-29><a id=__codelineno-49-29 name=__codelineno-49-29 href=#__codelineno-49-29></a>    <span class=nb>print</span><span class=p>(</span><span class=n>send_message_by_luosimao</span><span class=p>(</span><span class=s1>&#39;13500112233&#39;</span><span class=p>,</span> <span class=n>message</span><span class=p>))</span>
</span><span id=__span-49-30><a id=__codelineno-49-30 name=__codelineno-49-30 href=#__codelineno-49-30></a>
</span><span id=__span-49-31><a id=__codelineno-49-31 name=__codelineno-49-31 href=#__codelineno-49-31></a>
</span><span id=__span-49-32><a id=__codelineno-49-32 name=__codelineno-49-32 href=#__codelineno-49-32></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span><span id=__span-49-33><a id=__codelineno-49-33 name=__codelineno-49-33 href=#__codelineno-49-33></a>    <span class=n>main</span><span class=p>()</span>
</span></code></pre></div> <p>上面请求螺丝帽的短信网关<code>http://sms-api.luosimao.com/v1/send.json</code>会返回JSON格式的数据，如果返回<code>{'error': 0, 'msg': 'OK'}</code>就说明短信已经发送成功了，如果<code>error</code>的值不是<code>0</code>，可以通过查看官方的<a href=https://luosimao.com/docs/api/ >开发文档</a>了解到底哪个环节出了问题。螺丝帽平台常见的错误类型如下图所示。</p> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210820195505.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img src=https://github.com/jackfrued/mypic/raw/master/20210820195505.png alt=image-20210820195505761 style=zoom:50%;></a></p> <p>目前，大多数短信平台都会要求短信内容必须附上签名，下图是我在螺丝帽平台配置的短信签名“【Python小课】”。有些涉及到敏感内容的短信，还需要提前配置短信模板，有兴趣的读者可以自行研究。一般情况下，平台为了防范短信被盗用，还会要求设置“IP白名单”，不清楚如何配置的可以咨询平台客服。</p> <p><a class=glightbox href=https://github.com/jackfrued/mypic/raw/master/20210820194653.png data-type=image data-width=auto data-height=auto data-desc-position=bottom><img alt=image-20210820194653785 src=https://github.com/jackfrued/mypic/raw/master/20210820194653.png></a></p> <p>当然国内的短信平台很多，读者可以根据自己的需要进行选择（通常会考虑费用预算、短信达到率、使用的难易程度等指标），如果需要在商业项目中使用短信服务建议购买短信平台提供的套餐服务。</p> <h3 id=_13>简单的总结<a class=headerlink href=#_13 title="Permanent link">&para;</a></h3> <p>其实，发送邮件和发送短信一样，也可以通过调用三方服务来完成，在实际的商业项目中，建议自己架设邮件服务器或购买三方服务来发送邮件，这个才是比较靠谱的选择。</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2025年1月30日 17:29:37">2025年1月30日 17:29:37</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2025年1月30日 17:29:37">2025年1月30日 17:29:37</span> </span> </aside> <div id=__comments> <h3>颜色主题调整</h3> <div class=tx-switch> <button class=button1 data-md-color-primary=red style=background-color:red>red</button> <button class=button1 data-md-color-primary=pink style=background-color:pink;color:black>pink</button> <button class=button1 data-md-color-primary=purple style=background-color:purple>purple</button> <button class=button1 data-md-color-primary=indigo style=background-color:indigo>indigo</button> <button class=button1 data-md-color-primary=blue style=background-color:blue>blue</button> <button class=button1 data-md-color-primary=cyan style=background-color:cyan;color:black>cyan</button> <button class=button1 data-md-color-primary=teal style=background-color:teal>teal</button> <button class=button1 data-md-color-primary=green style=background-color:green>green</button> <button class=button1 data-md-color-primary=lime style=background-color:lime;color:black>lime</button> <button class=button1 data-md-color-primary=orange style=background-color:orange;color:black>orange</button> <button class=button1 data-md-color-primary=brown style="background-color:brown;border-radius: 3px">brown</button> <button class=button1 data-md-color-primary=grey style="background-color: grey;">grey</button> <button class=button1 data-md-color-primary=black style=background-color:black>black</button> <button class=button1 data-md-color-primary=white style=background-color:white;color:black>white</button> </div> <!-- Insert generated snippet here --> <script src=https://giscus.app/client.js data-repo=Zhang-Each/My-CS-Notebook data-repo-id=R_kgDOI0dr4w data-category=General data-category-id=DIC_kwDOI0dr484CTvIK data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async>
    </script> <script>
    var buttons = document.querySelectorAll("button[data-md-color-primary]")
    buttons.forEach(function(button) {
            button.addEventListener("click", function() {
            var attr = this.getAttribute("data-md-color-primary")
            document.body.setAttribute("data-md-color-primary", attr)
            localStorage.setItem("data-md-color-primary",attr);
            })
    })
    </script> <!-- Synchronize Giscus theme with palette --> <script>
var giscus = document.querySelector("script[src*=giscus]")

// Set palette on initial load
var palette = __md_get("__palette")
if (palette && typeof palette.color === "object") {
    var theme = palette.color.scheme === "slate"
    ? "dark_protanopia"
    : "light_protanopia"

    // Instruct Giscus to set theme
    giscus.setAttribute("data-theme", theme) 
}

// Register event handlers after documented loaded
document.addEventListener("DOMContentLoaded", function() {
    var ref = document.querySelector("[data-md-component=palette]")
    ref.addEventListener("change", function() {
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate"
        ? "dark_protanopia"
        : "light_protanopia"

        // Instruct Giscus to change theme
        var frame = document.querySelector(".giscus-frame")
        frame.contentWindow.postMessage(
        { giscus: { setConfig: { theme } } },
        "https://giscus.app"
        )
    }
    })
})
</script> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright © 2024 张瑞喆 All rights reserved. <a href=#__consent>Change cookie settings</a> </div> </div> <div class=md-social> <a href=https://github.com/r-z-zhang-AI target=_blank rel=noopener title="GitHub | r-z-zhang-AI" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics> <span class=task-list-indicator></span> Google Analytics </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"base": "../../../..", "features": ["navigation.tabs", "navigation.top", "navigation.indexes", "toc.follow", "search.suggest", "search.highlight", "content.code.copy", "content.action.edit", "announce.dismiss"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=../../../../mkdocs/javascripts/mathjax.js></script> <script src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>